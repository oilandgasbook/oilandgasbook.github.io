<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Create the phase diagram plot | Applications of Python in Reservoir Engineering</title>
  <meta name="description" content="15 Create the phase diagram plot | Applications of Python in Reservoir Engineering" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Create the phase diagram plot | Applications of Python in Reservoir Engineering" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Create the phase diagram plot | Applications of Python in Reservoir Engineering" />
  
  
  

<meta name="author" content="Pramod Azad" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="this-equation-assumes-constant-enthalpy-of-vaporization.html"/>
<link rel="next" href="properties-of-oil.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> License</a></li>
<li class="chapter" data-level="2" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html"><i class="fa fa-check"></i><b>2</b> Chapter 1: Introduction to Python for Reservoir Engineering</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#why-python"><i class="fa fa-check"></i><b>2.1</b> Why Python?</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#versatility"><i class="fa fa-check"></i><b>2.2</b> Versatility</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#readability-and-learnability"><i class="fa fa-check"></i><b>2.3</b> Readability and Learnability</a></li>
<li class="chapter" data-level="2.4" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#open-source-community"><i class="fa fa-check"></i><b>2.4</b> Open Source Community</a></li>
<li class="chapter" data-level="2.5" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#extensive-libraries"><i class="fa fa-check"></i><b>2.5</b> Extensive Libraries</a></li>
<li class="chapter" data-level="2.6" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#conclusion-pythons-role-in-reservoir-engineering"><i class="fa fa-check"></i><b>2.6</b> Conclusion: Python’s Role in Reservoir Engineering</a></li>
<li class="chapter" data-level="2.7" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#getting-started-with-python"><i class="fa fa-check"></i><b>2.7</b> Getting Started with Python</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#introduction"><i class="fa fa-check"></i><b>2.7.1</b> Introduction</a></li>
<li class="chapter" data-level="2.7.2" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#installing-python"><i class="fa fa-check"></i><b>2.7.2</b> Installing Python</a></li>
<li class="chapter" data-level="2.7.3" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#choosing-a-python-distribution"><i class="fa fa-check"></i><b>2.7.3</b> Choosing a Python Distribution</a></li>
<li class="chapter" data-level="2.7.4" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#downloading-anaconda"><i class="fa fa-check"></i><b>2.7.4</b> Downloading Anaconda</a></li>
<li class="chapter" data-level="2.7.5" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#verifying-the-installation"><i class="fa fa-check"></i><b>2.7.5</b> Verifying the Installation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#setting-up-your-python-environment"><i class="fa fa-check"></i><b>2.8</b> Setting Up Your Python Environment</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#manual-virtual-environment"><i class="fa fa-check"></i><b>2.8.1</b> Manual Virtual Environment</a></li>
<li class="chapter" data-level="2.8.2" data-path="chapter-1-introduction-to-python-for-reservoir-engineering.html"><a href="chapter-1-introduction-to-python-for-reservoir-engineering.html#creating-a-virtual-environment-with-anaconda"><i class="fa fa-check"></i><b>2.8.2</b> Creating a Virtual Environment with Anaconda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="python-basics.html"><a href="python-basics.html"><i class="fa fa-check"></i><b>3</b> Python Basics</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="python-basics.html"><a href="python-basics.html#datatypes"><i class="fa fa-check"></i><b>3.0.1</b> Datatypes</a></li>
<li class="chapter" data-level="3.1" data-path="python-basics.html"><a href="python-basics.html#lists"><i class="fa fa-check"></i><b>3.1</b> Lists</a></li>
<li class="chapter" data-level="3.2" data-path="python-basics.html"><a href="python-basics.html#list-comprehensions"><i class="fa fa-check"></i><b>3.2</b> List comprehensions</a></li>
<li class="chapter" data-level="3.3" data-path="python-basics.html"><a href="python-basics.html#tuples"><i class="fa fa-check"></i><b>3.3</b> Tuples</a></li>
<li class="chapter" data-level="3.4" data-path="python-basics.html"><a href="python-basics.html#dictionaries"><i class="fa fa-check"></i><b>3.4</b> Dictionaries</a></li>
<li class="chapter" data-level="3.5" data-path="python-basics.html"><a href="python-basics.html#set"><i class="fa fa-check"></i><b>3.5</b> Set</a></li>
<li class="chapter" data-level="3.6" data-path="python-basics.html"><a href="python-basics.html#control-flow-and-functions"><i class="fa fa-check"></i><b>3.6</b> Control Flow and Functions</a></li>
<li class="chapter" data-level="3.7" data-path="python-basics.html"><a href="python-basics.html#python-libraries-for-reservoir-engineering"><i class="fa fa-check"></i><b>3.7</b> Python Libraries for Reservoir Engineering</a></li>
<li class="chapter" data-level="3.8" data-path="python-basics.html"><a href="python-basics.html#hands-on-practice"><i class="fa fa-check"></i><b>3.8</b> Hands-On Practice</a></li>
<li class="chapter" data-level="3.9" data-path="python-basics.html"><a href="python-basics.html#chapter-summary"><i class="fa fa-check"></i><b>3.9</b> Chapter Summary</a></li>
<li class="chapter" data-level="3.10" data-path="python-basics.html"><a href="python-basics.html#further-reading"><i class="fa fa-check"></i><b>3.10</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-mathematics.html"><a href="simple-mathematics.html"><i class="fa fa-check"></i><b>4</b> Simple Mathematics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-mathematics.html"><a href="simple-mathematics.html#comparisons"><i class="fa fa-check"></i><b>4.1</b> Comparisons</a></li>
<li class="chapter" data-level="4.2" data-path="simple-mathematics.html"><a href="simple-mathematics.html#conditionals"><i class="fa fa-check"></i><b>4.2</b> Conditionals</a></li>
<li class="chapter" data-level="4.3" data-path="simple-mathematics.html"><a href="simple-mathematics.html#if-elif-and-else"><i class="fa fa-check"></i><b>4.3</b> if, elif, and else</a></li>
<li class="chapter" data-level="4.4" data-path="simple-mathematics.html"><a href="simple-mathematics.html#boolean-operators"><i class="fa fa-check"></i><b>4.4</b> Boolean Operators</a></li>
<li class="chapter" data-level="4.5" data-path="simple-mathematics.html"><a href="simple-mathematics.html#loops"><i class="fa fa-check"></i><b>4.5</b> Loops</a></li>
<li class="chapter" data-level="4.6" data-path="simple-mathematics.html"><a href="simple-mathematics.html#for-loops"><i class="fa fa-check"></i><b>4.6</b> For loops</a></li>
<li class="chapter" data-level="4.7" data-path="simple-mathematics.html"><a href="simple-mathematics.html#while-loop"><i class="fa fa-check"></i><b>4.7</b> While Loop</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="simple-mathematics.html"><a href="simple-mathematics.html#break-statement"><i class="fa fa-check"></i><b>4.7.1</b> <code>break</code> statement</a></li>
<li class="chapter" data-level="4.7.2" data-path="simple-mathematics.html"><a href="simple-mathematics.html#continue-statement"><i class="fa fa-check"></i><b>4.7.2</b> <code>continue</code> statement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html"><i class="fa fa-check"></i><b>5</b> Built in Modules and Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#creating-a-module"><i class="fa fa-check"></i><b>5.1</b> Creating a module</a></li>
<li class="chapter" data-level="5.2" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#installing-external-modules-using-pip"><i class="fa fa-check"></i><b>5.2</b> Installing external modules using pip</a></li>
<li class="chapter" data-level="5.3" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#functions"><i class="fa fa-check"></i><b>5.3</b> Functions</a></li>
<li class="chapter" data-level="5.4" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#lambda-function"><i class="fa fa-check"></i><b>5.4</b> Lambda function</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html"><i class="fa fa-check"></i><b>6</b> Introduction to Numpy</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#why-is-numpy-fast"><i class="fa fa-check"></i><b>6.1</b> Why is NumPy Fast?</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#n-dimensional-arrays"><i class="fa fa-check"></i><b>6.2</b> N-Dimensional Arrays</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#creating-ndarrays"><i class="fa fa-check"></i><b>6.2.1</b> Creating ndarrays</a></li>
<li class="chapter" data-level="6.2.2" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#understanding-the-shape-and-dimensions-of-arrays"><i class="fa fa-check"></i><b>6.2.2</b> Understanding the Shape and Dimensions of Arrays</a></li>
<li class="chapter" data-level="6.2.3" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#manipulating-and-operating-on-ndarrays"><i class="fa fa-check"></i><b>6.2.3</b> Manipulating and Operating on ndarrays</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#universal-functions-ufuncs"><i class="fa fa-check"></i><b>6.3</b> Universal Functions (ufuncs)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#basic-arithmetic-operations"><i class="fa fa-check"></i><b>6.3.1</b> Basic Arithmetic Operations</a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#mathematical-functions"><i class="fa fa-check"></i><b>6.3.2</b> Mathematical Functions</a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#aggregation-functions-1"><i class="fa fa-check"></i><b>6.3.3</b> Aggregation Functions</a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#broadcasting-for-operations-on-arrays-of-different-shapes"><i class="fa fa-check"></i><b>6.3.4</b> Broadcasting for Operations on Arrays of Different Shapes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#array-manipulation"><i class="fa fa-check"></i><b>6.4</b> Array Manipulation</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#reshaping-arrays"><i class="fa fa-check"></i><b>6.4.1</b> Reshaping Arrays</a></li>
<li class="chapter" data-level="6.4.2" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#concatenating-arrays"><i class="fa fa-check"></i><b>6.4.2</b> Concatenating Arrays</a></li>
<li class="chapter" data-level="6.4.3" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#splitting-arrays"><i class="fa fa-check"></i><b>6.4.3</b> Splitting Arrays</a></li>
<li class="chapter" data-level="6.4.4" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#indexing-and-slicing-1"><i class="fa fa-check"></i><b>6.4.4</b> Indexing and Slicing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html"><i class="fa fa-check"></i><b>7</b> Reservoir Engineering</a>
<ul>
<li class="chapter" data-level="7.1" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#reservoir-characteristics"><i class="fa fa-check"></i><b>7.2</b> Reservoir Characteristics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#reservoir-rock"><i class="fa fa-check"></i><b>7.2.1</b> Reservoir Rock</a></li>
<li class="chapter" data-level="7.2.2" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#fluid-properties"><i class="fa fa-check"></i><b>7.2.2</b> Fluid Properties</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#reservoir-drive-mechanisms"><i class="fa fa-check"></i><b>7.3</b> Reservoir Drive Mechanisms</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#natural-gas-drive"><i class="fa fa-check"></i><b>7.3.1</b> Natural Gas Drive</a></li>
<li class="chapter" data-level="7.3.2" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#water-drive"><i class="fa fa-check"></i><b>7.3.2</b> Water Drive</a></li>
<li class="chapter" data-level="7.3.3" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#other-drive-mechanisms"><i class="fa fa-check"></i><b>7.3.3</b> Other Drive Mechanisms</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#reservoir-types"><i class="fa fa-check"></i><b>7.4</b> Reservoir Types</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#oil-reservoirs"><i class="fa fa-check"></i><b>7.4.1</b> Oil Reservoirs</a></li>
<li class="chapter" data-level="7.4.2" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#gas-reservoirs"><i class="fa fa-check"></i><b>7.4.2</b> Gas Reservoirs</a></li>
<li class="chapter" data-level="7.4.3" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#oil-and-gas-reservoirs"><i class="fa fa-check"></i><b>7.4.3</b> Oil and Gas Reservoirs</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#reservoir-evaluation"><i class="fa fa-check"></i><b>7.5</b> Reservoir Evaluation</a></li>
<li class="chapter" data-level="7.6" data-path="reservoir-engineering.html"><a href="reservoir-engineering.html#chapter-summary-1"><i class="fa fa-check"></i><b>7.6</b> Chapter Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html"><i class="fa fa-check"></i><b>8</b> Fundamental Properties of Gas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html#gas-behavior"><i class="fa fa-check"></i><b>8.1</b> Gas Behavior</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html#ideal-gas-law"><i class="fa fa-check"></i><b>8.1.1</b> Ideal Gas Law</a></li>
<li class="chapter" data-level="8.1.2" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html#real-gas-behavior"><i class="fa fa-check"></i><b>8.1.2</b> Real Gas Behavior</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html#phase-behavior"><i class="fa fa-check"></i><b>8.2</b> Phase Behavior</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fundamental-properties-of-gas.html"><a href="fundamental-properties-of-gas.html#phase-diagrams"><i class="fa fa-check"></i><b>8.2.1</b> Phase Diagrams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="constants-for-water-h2o.html"><a href="constants-for-water-h2o.html"><i class="fa fa-check"></i><b>9</b> Constants for water (H2O)</a></li>
<li class="chapter" data-level="10" data-path="temperature-range-k.html"><a href="temperature-range-k.html"><i class="fa fa-check"></i><b>10</b> Temperature range (K)</a></li>
<li class="chapter" data-level="11" data-path="pressure-range-atm.html"><a href="pressure-range-atm.html"><i class="fa fa-check"></i><b>11</b> Pressure range (atm)</a></li>
<li class="chapter" data-level="12" data-path="create-a-grid-of-pressure-and-temperature-values.html"><a href="create-a-grid-of-pressure-and-temperature-values.html"><i class="fa fa-check"></i><b>12</b> Create a grid of pressure and temperature values</a></li>
<li class="chapter" data-level="13" data-path="calculate-the-phase-boundary-boiling-curve-using-a-simplified-equation.html"><a href="calculate-the-phase-boundary-boiling-curve-using-a-simplified-equation.html"><i class="fa fa-check"></i><b>13</b> Calculate the phase boundary (boiling curve) using a simplified equation</a></li>
<li class="chapter" data-level="14" data-path="this-equation-assumes-constant-enthalpy-of-vaporization.html"><a href="this-equation-assumes-constant-enthalpy-of-vaporization.html"><i class="fa fa-check"></i><b>14</b> This equation assumes constant enthalpy of vaporization</a></li>
<li class="chapter" data-level="15" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html"><i class="fa fa-check"></i><b>15</b> Create the phase diagram plot</a>
<ul>
<li class="chapter" data-level="15.1" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#review-of-gas-properties"><i class="fa fa-check"></i><b>15.1</b> Review of Gas Properties</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#real-gas-law"><i class="fa fa-check"></i><b>15.1.1</b> Real Gas law</a></li>
<li class="chapter" data-level="15.1.2" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#gas-z-factor"><i class="fa fa-check"></i><b>15.1.2</b> Gas z Factor</a></li>
<li class="chapter" data-level="15.1.3" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#gas-density"><i class="fa fa-check"></i><b>15.1.3</b> Gas Density</a></li>
<li class="chapter" data-level="15.1.4" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#isothermal-gas-compressibility"><i class="fa fa-check"></i><b>15.1.4</b> Isothermal Gas Compressibility</a></li>
<li class="chapter" data-level="15.1.5" data-path="create-the-phase-diagram-plot.html"><a href="create-the-phase-diagram-plot.html#gas-formation-volume-factor"><i class="fa fa-check"></i><b>15.1.5</b> Gas formation volume factor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="properties-of-oil.html"><a href="properties-of-oil.html"><i class="fa fa-check"></i><b>16</b> Properties of Oil</a></li>
<li class="chapter" data-level="17" data-path="rock-properties.html"><a href="rock-properties.html"><i class="fa fa-check"></i><b>17</b> Rock Properties</a>
<ul>
<li class="chapter" data-level="17.1" data-path="rock-properties.html"><a href="rock-properties.html#surface-and-interfacial-tension"><i class="fa fa-check"></i><b>17.1</b> Surface and Interfacial Tension</a></li>
<li class="chapter" data-level="17.2" data-path="rock-properties.html"><a href="rock-properties.html#capillary-pressure"><i class="fa fa-check"></i><b>17.2</b> Capillary Pressure</a></li>
<li class="chapter" data-level="17.3" data-path="rock-properties.html"><a href="rock-properties.html#leverett-j-function"><i class="fa fa-check"></i><b>17.3</b> Leverett J-Function</a></li>
<li class="chapter" data-level="17.4" data-path="rock-properties.html"><a href="rock-properties.html#permeability"><i class="fa fa-check"></i><b>17.4</b> Permeability</a></li>
<li class="chapter" data-level="17.5" data-path="rock-properties.html"><a href="rock-properties.html#reservoir-heterogeneity"><i class="fa fa-check"></i><b>17.5</b> Reservoir Heterogeneity</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="rock-properties.html"><a href="rock-properties.html#vertical-heterogeneity"><i class="fa fa-check"></i><b>17.5.1</b> Vertical Heterogeneity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="relative-permeability.html"><a href="relative-permeability.html"><i class="fa fa-check"></i><b>18</b> Relative Permeability</a>
<ul>
<li class="chapter" data-level="18.1" data-path="relative-permeability.html"><a href="relative-permeability.html#three-phase-relative-permeability"><i class="fa fa-check"></i><b>18.1</b> Three-phase relative permeability</a></li>
<li class="chapter" data-level="18.2" data-path="relative-permeability.html"><a href="relative-permeability.html#simplified-fractional-flow-equation"><i class="fa fa-check"></i><b>18.2</b> Simplified Fractional Flow Equation</a></li>
<li class="chapter" data-level="18.3" data-path="relative-permeability.html"><a href="relative-permeability.html#buckley-leverett-theory"><i class="fa fa-check"></i><b>18.3</b> Buckley-Leverett Theory</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="fundamentals-of-fluid-flow-in-reservoirs.html"><a href="fundamentals-of-fluid-flow-in-reservoirs.html"><i class="fa fa-check"></i><b>19</b> Fundamentals of fluid flow in Reservoirs</a>
<ul>
<li class="chapter" data-level="19.1" data-path="fundamentals-of-fluid-flow-in-reservoirs.html"><a href="fundamentals-of-fluid-flow-in-reservoirs.html#type-of-fluids-in-reservoir"><i class="fa fa-check"></i><b>19.1</b> Type of fluids in reservoir</a></li>
<li class="chapter" data-level="19.2" data-path="fundamentals-of-fluid-flow-in-reservoirs.html"><a href="fundamentals-of-fluid-flow-in-reservoirs.html#fluid-flow-equation"><i class="fa fa-check"></i><b>19.2</b> Fluid flow equation</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="pattern-floods.html"><a href="pattern-floods.html"><i class="fa fa-check"></i><b>20</b> Pattern Floods</a>
<ul>
<li class="chapter" data-level="20.1" data-path="pattern-floods.html"><a href="pattern-floods.html#recovery-efficiency"><i class="fa fa-check"></i><b>20.1</b> Recovery Efficiency</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="pattern-floods.html"><a href="pattern-floods.html#patterns-and-spacing"><i class="fa fa-check"></i><b>20.1.1</b> Patterns and Spacing</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="pattern-floods.html"><a href="pattern-floods.html#pattern-recovery"><i class="fa fa-check"></i><b>20.2</b> Pattern Recovery</a></li>
<li class="chapter" data-level="20.3" data-path="pattern-floods.html"><a href="pattern-floods.html#aa"><i class="fa fa-check"></i><b>20.3</b> aa</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pressure-transient-analysis.html"><a href="pressure-transient-analysis.html"><i class="fa fa-check"></i><b>21</b> Pressure Transient Analysis</a>
<ul>
<li class="chapter" data-level="21.1" data-path="pressure-transient-analysis.html"><a href="pressure-transient-analysis.html#basic-well-model"><i class="fa fa-check"></i><b>21.1</b> Basic Well Model</a></li>
<li class="chapter" data-level="21.2" data-path="pressure-transient-analysis.html"><a href="pressure-transient-analysis.html#steady-state-radial-flow-of-an-incompressible-fluid"><i class="fa fa-check"></i><b>21.2</b> Steady-State Radial Flow of an Incompressible Fluid</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="volumetrics.html"><a href="volumetrics.html"><i class="fa fa-check"></i><b>22</b> Volumetrics</a>
<ul>
<li class="chapter" data-level="22.1" data-path="volumetrics.html"><a href="volumetrics.html#calculating-the-gas-inplace-by-volumetric-methods"><i class="fa fa-check"></i><b>22.1</b> Calculating the Gas inplace by volumetric methods</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html"><i class="fa fa-check"></i><b>23</b> Gas and Water Coning</a>
<ul>
<li class="chapter" data-level="23.1" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#coning-in-vertical-wells"><i class="fa fa-check"></i><b>23.1</b> Coning in Vertical wells</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#meyer-garder-correlation"><i class="fa fa-check"></i><b>23.1.1</b> Meyer-Garder Correlation</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#coning-in-horizontal-wells"><i class="fa fa-check"></i><b>23.2</b> Coning in Horizontal wells</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="working-with-las-files.html"><a href="working-with-las-files.html"><i class="fa fa-check"></i><b>24</b> working with Las files</a>
<ul>
<li class="chapter" data-level="24.1" data-path="working-with-las-files.html"><a href="working-with-las-files.html#basic-example"><i class="fa fa-check"></i><b>24.1</b> Basic example</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="rough.html"><a href="rough.html"><i class="fa fa-check"></i><b>25</b> rough</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of Python in Reservoir Engineering</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="create-the-phase-diagram-plot" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Create the phase diagram plot<a href="create-the-phase-diagram-plot.html#create-the-phase-diagram-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>plt.figure(figsize=(8, 6))
plt.contourf(P, T, T_boiling_curve, levels=20, cmap=‘coolwarm’)
plt.colorbar(label=‘Temperature (K)’)
plt.xlabel(‘Pressure (atm)’)
plt.ylabel(‘Temperature (K)’)
plt.title(‘Phase Diagram of Water (Simplified)’)
plt.yscale(‘log’) # Logarithmic scale for pressure
plt.ylim(200, 800)
plt.xlim(0.001, 300)
plt.grid(True)
plt.show()</p>
<pre><code>Phase diagrams are crucial tools for reservoir engineers as they enable the prediction of phase transitions and phase equilibria within the reservoir.

In a phase diagram, the critical point stands out as a critical temperature (Tc) and critical pressure (Pc) where a phase transition occurs. The phase diagram allows engineers to assess how far the actual reservoir conditions are from the critical point, influencing decisions regarding production strategies and well operations.

#### Critical Point and Phase Transitions

The critical point (also known as the critical state) is a specific condition at which a substance undergoes a phase transition. At the critical point, the distinction between the liquid and gas phases disappears, and the substance becomes a supercritical fluid. This transition has significant implications for reservoir engineers because it affects how gases behave at extreme reservoir conditions.

The critical point is characterized by the critical temperature (Tc) and critical pressure (Pc), which are unique to each gas component. These critical properties vary depending on the type of gas present in the reservoir. Understanding the critical point and its proximity to reservoir conditions is essential for predicting phase transitions and ensuring accurate reservoir simulations.

#### different correlation to calculate critical temperature (Tc) and critical pressure (Pc)

Here are five different correlations along with Python code chunks to calculate critical temperature (Tc) and critical pressure (Pc). Each correlation provides an estimation of these critical properties based on different parameters. Please note that these correlations provide approximate values and may have varying degrees of accuracy depending on the specific gas mixture and conditions. 

##### Lee-Kesler Equation

The Lee-Kesler equation is a common method to estimate critical temperature (Tc) and critical pressure (Pc) for pure gases. This equation requires knowledge of the acentric factor (ω) and the gas&#39;s reduced temperature (Tr).

The Lee-Kesler equation for critical temperature (Tc) is:

\[ Tc = Tc_r \cdot Tc_{RK} \]

And for critical pressure (Pc):

\[ Pc = Pc_r \cdot Pc_{RK} \]

Where \( Tc_r \) and \( Pc_r \) are the critical properties from the Redlich-Kwong equation of state, and \( Tc_{RK} \) and \( Pc_{RK} \) are constants derived from the acentric factor (ω).

Here&#39;s Python code to calculate Tc and Pc using the Lee-Kesler equation:

```python
# Constants for Lee-Kesler equation
Tc_rk = 190.56  # Critical temperature from Redlich-Kwong (RK) EOS
Pc_rk = 45.99   # Critical pressure from Redlich-Kwong (RK) EOS
omega = 0.011   # Acentric factor

# Calculate Tc and Pc using Lee-Kesler equation
Tc = Tc_rk * (1 + omega)  # Critical temperature
Pc = Pc_rk / (1 + omega)   # Critical pressure

print(f&quot;Estimated Critical Temperature (Tc): {Tc} K&quot;)
print(f&quot;Estimated Critical Pressure (Pc): {Pc} atm&quot;)</code></pre>
<div id="beattie-bridgeman-equation" class="section level4 hasAnchor" number="15.0.0.1">
<h4><span class="header-section-number">15.0.0.1</span> Beattie-Bridgeman Equation<a href="create-the-phase-diagram-plot.html#beattie-bridgeman-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Beattie-Bridgeman equation provides an estimation of critical temperature (Tc) and critical pressure (Pc) for pure gases based on the triple point temperature (Tt) and the gas’s molecular weight (M).</p>
<p>The Beattie-Bridgeman equation for critical temperature (Tc) is:</p>
<p><span class="math display">\[ Tc = 3.2 \cdot Tt + 11.5 \cdot M \]</span></p>
<p>And for critical pressure (Pc):</p>
<p><span class="math display">\[ Pc = 42.5 \cdot \frac{M^2}{Vc} \]</span></p>
<p>Where <span class="math inline">\(Vc\)</span> is the critical volume, which can be estimated as <span class="math inline">\(Vc = 10 \cdot M\)</span>.</p>
<p>Here’s Python code to calculate Tc and Pc using the Beattie-Bridgeman equation:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="create-the-phase-diagram-plot.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Beattie-Bridgeman equation</span></span>
<span id="cb130-2"><a href="create-the-phase-diagram-plot.html#cb130-2" aria-hidden="true" tabindex="-1"></a>Tt <span class="op">=</span> <span class="fl">273.16</span>  <span class="co"># Triple point temperature in K</span></span>
<span id="cb130-3"><a href="create-the-phase-diagram-plot.html#cb130-3" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">28.97</span>    <span class="co"># Molecular weight of nitrogen (for example)</span></span>
<span id="cb130-4"><a href="create-the-phase-diagram-plot.html#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="create-the-phase-diagram-plot.html#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate critical volume (Vc)</span></span>
<span id="cb130-6"><a href="create-the-phase-diagram-plot.html#cb130-6" aria-hidden="true" tabindex="-1"></a>Vc <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> M</span>
<span id="cb130-7"><a href="create-the-phase-diagram-plot.html#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="create-the-phase-diagram-plot.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Tc and Pc using Beattie-Bridgeman equation</span></span>
<span id="cb130-9"><a href="create-the-phase-diagram-plot.html#cb130-9" aria-hidden="true" tabindex="-1"></a>Tc <span class="op">=</span> <span class="fl">3.2</span> <span class="op">*</span> Tt <span class="op">+</span> <span class="fl">11.5</span> <span class="op">*</span> M  <span class="co"># Critical temperature</span></span>
<span id="cb130-10"><a href="create-the-phase-diagram-plot.html#cb130-10" aria-hidden="true" tabindex="-1"></a>Pc <span class="op">=</span> <span class="fl">42.5</span> <span class="op">*</span> (M <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> Vc  <span class="co"># Critical pressure</span></span>
<span id="cb130-11"><a href="create-the-phase-diagram-plot.html#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="create-the-phase-diagram-plot.html#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Temperature (Tc): </span><span class="sc">{Tc}</span><span class="ss"> K&quot;</span>)</span>
<span id="cb130-13"><a href="create-the-phase-diagram-plot.html#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Pressure (Pc): </span><span class="sc">{Pc}</span><span class="ss"> atm&quot;</span>)</span></code></pre></div>
<p>This code estimates Tc and Pc using the Beattie-Bridgeman equation based on the provided triple point temperature (Tt) and molecular weight (M).</p>
</div>
<div id="riedel-equation" class="section level4 hasAnchor" number="15.0.0.2">
<h4><span class="header-section-number">15.0.0.2</span> Riedel Equation<a href="create-the-phase-diagram-plot.html#riedel-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Riedel equation offers an estimation of critical temperature (Tc) and critical pressure (Pc) for pure gases using the gas’s boiling point (Tb) and the critical temperature of methane (Tc_CH4).</p>
<p>The Riedel equation for critical temperature (Tc) is:</p>
<p><span class="math display">\[ Tc = Tc_{CH4} + 27.9 \cdot (Tb - Tc_{CH4}) \]</span></p>
<p>And for critical pressure (Pc):</p>
<p><span class="math display">\[ Pc = 10.6 \cdot \left(1 - \frac{Tc}{Tb}\right) \]</span></p>
<p>Where <span class="math inline">\(Tc_{CH4}\)</span> is the critical temperature of methane (Tc_CH4 = 190.6 K).</p>
<p>Here’s Python code to calculate Tc and Pc using the Riedel equation:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="create-the-phase-diagram-plot.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Riedel equation</span></span>
<span id="cb131-2"><a href="create-the-phase-diagram-plot.html#cb131-2" aria-hidden="true" tabindex="-1"></a>Tb <span class="op">=</span> <span class="fl">77.36</span>  <span class="co"># Boiling point of nitrogen (for example) in K</span></span>
<span id="cb131-3"><a href="create-the-phase-diagram-plot.html#cb131-3" aria-hidden="true" tabindex="-1"></a>Tc_CH4 <span class="op">=</span> <span class="fl">190.6</span>  <span class="co"># Critical temperature of methane in K</span></span>
<span id="cb131-4"><a href="create-the-phase-diagram-plot.html#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="create-the-phase-diagram-plot.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Tc and Pc using Riedel equation</span></span>
<span id="cb131-6"><a href="create-the-phase-diagram-plot.html#cb131-6" aria-hidden="true" tabindex="-1"></a>Tc <span class="op">=</span> Tc_CH4 <span class="op">+</span> <span class="fl">27.9</span> <span class="op">*</span> (Tb <span class="op">-</span> Tc_CH4)  <span class="co"># Critical temperature</span></span>
<span id="cb131-7"><a href="create-the-phase-diagram-plot.html#cb131-7" aria-hidden="true" tabindex="-1"></a>Pc <span class="op">=</span> <span class="fl">10.6</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Tc <span class="op">/</span> Tb)  <span class="co"># Critical pressure</span></span>
<span id="cb131-8"><a href="create-the-phase-diagram-plot.html#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="create-the-phase-diagram-plot.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Temperature (Tc): </span><span class="sc">{Tc}</span><span class="ss"> K&quot;</span>)</span>
<span id="cb131-10"><a href="create-the-phase-diagram-plot.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Pressure (Pc): </span><span class="sc">{Pc}</span><span class="ss"> atm&quot;</span>)</span></code></pre></div>
</div>
<div id="yaws-equation" class="section level4 hasAnchor" number="15.0.0.3">
<h4><span class="header-section-number">15.0.0.3</span> Yaws’ Equation<a href="create-the-phase-diagram-plot.html#yaws-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Yaws’ equation offers a straightforward approach to estimate critical temperature (Tc) and critical pressure (Pc) for hydrocarbon gases using the gas’s molecular weight (M) and the number of carbon atoms (C).</p>
<p>The Yaws’ equation for critical temperature (Tc) is:</p>
<p><span class="math display">\[ Tc = 169 + 0.684 \cdot M + 0.0007 \cdot M^2 \]</span></p>
<p>And for critical pressure (Pc):</p>
<p><span class="math display">\[ Pc = 708 - 3.6 \cdot C \]</span></p>
<p>Here’s Python code to calculate Tc and Pc using Yaws’ equation:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="create-the-phase-diagram-plot.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Yaws&#39; equation</span></span>
<span id="cb132-2"><a href="create-the-phase-diagram-plot.html#cb132-2" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">16.04</span>  <span class="co"># Molecular weight of methane (for example)</span></span>
<span id="cb132-3"><a href="create-the-phase-diagram-plot.html#cb132-3" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> <span class="dv">1</span>      <span class="co"># Number of carbon atoms in methane</span></span>
<span id="cb132-4"><a href="create-the-phase-diagram-plot.html#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="create-the-phase-diagram-plot.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Tc and Pc using Yaws&#39; equation</span></span>
<span id="cb132-6"><a href="create-the-phase-diagram-plot.html#cb132-6" aria-hidden="true" tabindex="-1"></a>Tc <span class="op">=</span> <span class="dv">169</span> <span class="op">+</span> <span class="fl">0.684</span> <span class="op">*</span> M <span class="op">+</span> <span class="fl">0.0007</span> <span class="op">*</span> M<span class="op">**</span><span class="dv">2</span>  <span class="co"># Critical temperature</span></span>
<span id="cb132-7"><a href="create-the-phase-diagram-plot.html#cb132-7" aria-hidden="true" tabindex="-1"></a>Pc <span class="op">=</span> <span class="dv">708</span> <span class="op">-</span> <span class="fl">3.6</span> <span class="op">*</span> C  <span class="co"># Critical pressure</span></span>
<span id="cb132-8"><a href="create-the-phase-diagram-plot.html#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="create-the-phase-diagram-plot.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Temperature (Tc): </span><span class="sc">{Tc}</span><span class="ss"> K&quot;</span>)</span>
<span id="cb132-10"><a href="create-the-phase-diagram-plot.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Pressure (Pc): </span><span class="sc">{Pc}</span><span class="ss"> atm&quot;</span>)</span></code></pre></div>
</div>
<div id="pitzer-equation" class="section level4 hasAnchor" number="15.0.0.4">
<h4><span class="header-section-number">15.0.0.4</span> Pitzer Equation<a href="create-the-phase-diagram-plot.html#pitzer-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Pitzer equation provides an estimation of critical temperature (Tc) and critical pressure (Pc) for gases using the critical temperature of methane (Tc_CH4) and the molecular weight (M).</p>
<p>The Pitzer equation for critical temperature (Tc) is:</p>
<p><span class="math display">\[ Tc = Tc_{CH4} \cdot \left(1 + \frac{1}{4} \cdot (1 - \sqrt{M})\right) \]</span></p>
<p>And for critical pressure (Pc):</p>
<p><span class="math display">\[ Pc = 67 \cdot \left(1 - \sqrt{M}\right)^3 \]</span></p>
<p>Here’s Python code to calculate Tc and Pc using the Pitzer equation:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="create-the-phase-diagram-plot.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Pitzer equation</span></span>
<span id="cb133-2"><a href="create-the-phase-diagram-plot.html#cb133-2" aria-hidden="true" tabindex="-1"></a>Tc_CH4 <span class="op">=</span> <span class="fl">190.6</span>  <span class="co"># Critical temperature of methane in K</span></span>
<span id="cb133-3"><a href="create-the-phase-diagram-plot.html#cb133-3" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">28.97</span>       <span class="co"># Molecular weight of nitrogen (for example)</span></span>
<span id="cb133-4"><a href="create-the-phase-diagram-plot.html#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="create-the-phase-diagram-plot.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Tc and Pc using Pitzer equation</span></span>
<span id="cb133-6"><a href="create-the-phase-diagram-plot.html#cb133-6" aria-hidden="true" tabindex="-1"></a>Tc <span class="op">=</span> Tc_CH4 <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> M<span class="op">**</span><span class="fl">0.5</span>))  <span class="co"># Critical temperature</span></span>
<span id="cb133-7"><a href="create-the-phase-diagram-plot.html#cb133-7" aria-hidden="true" tabindex="-1"></a>Pc <span class="op">=</span> <span class="dv">67</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> M<span class="op">**</span><span class="fl">0.5</span>)<span class="op">**</span><span class="dv">3</span>  <span class="co"># Critical pressure</span></span>
<span id="cb133-8"><a href="create-the-phase-diagram-plot.html#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="create-the-phase-diagram-plot.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Temperature (Tc): </span><span class="sc">{Tc}</span><span class="ss"> K&quot;</span>)</span>
<span id="cb133-10"><a href="create-the-phase-diagram-plot.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Critical Pressure (Pc): </span><span class="sc">{Pc}</span><span class="ss"> atm&quot;</span>)</span></code></pre></div>
</div>
<div id="review-of-gas-properties" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Review of Gas Properties<a href="create-the-phase-diagram-plot.html#review-of-gas-properties" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="real-gas-law" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Real Gas law<a href="create-the-phase-diagram-plot.html#real-gas-law" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are no gas that behaves as Ideal gas. The volume of Real gas is more that Ideal gas. The number that measure the amount of gas deviates from perfect gas is actually a ratio.
this ratio is called as compressibility factor or gas deviation factor. this is a dimensionless quantity.</p>
<p>If the gas deviation factor is not measured it can be estimated from the specific gravity of the gas.
Sutton developed a correlation that estimates</p>
<p><span class="math display" id="eq:azad">\[\begin{equation}
    \tag{15.1}
    Ppc = 756.8 -131*Sg - 3.6 * Sg^2 \\
    Tpc = 169.2 -349.5*Sg - 74 * Sg^2
\end{equation}\]</span></p>
<p>We will write a small code to plot this correlation.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="create-the-phase-diagram-plot.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb134-2"><a href="create-the-phase-diagram-plot.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb134-3"><a href="create-the-phase-diagram-plot.html#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="create-the-phase-diagram-plot.html#cb134-4" aria-hidden="true" tabindex="-1"></a>Sg <span class="op">=</span> np.arange(<span class="fl">0.57</span>,<span class="fl">1.68</span>,<span class="fl">0.05</span>)</span>
<span id="cb134-5"><a href="create-the-phase-diagram-plot.html#cb134-5" aria-hidden="true" tabindex="-1"></a>Ppc <span class="op">=</span> [<span class="fl">756.8</span> <span class="op">-</span><span class="dv">131</span><span class="op">*</span>sg <span class="op">-</span> <span class="fl">3.6</span> <span class="op">*</span> sg<span class="op">*</span>sg <span class="cf">for</span> sg <span class="kw">in</span> Sg]</span>
<span id="cb134-6"><a href="create-the-phase-diagram-plot.html#cb134-6" aria-hidden="true" tabindex="-1"></a>Tpc <span class="op">=</span> [<span class="fl">169.2</span> <span class="op">+</span> <span class="fl">349.5</span><span class="op">*</span>sg <span class="op">-</span> <span class="dv">74</span> <span class="op">*</span> sg<span class="op">*</span>sg <span class="cf">for</span> sg <span class="kw">in</span> Sg]</span>
<span id="cb134-7"><a href="create-the-phase-diagram-plot.html#cb134-7" aria-hidden="true" tabindex="-1"></a>plt.plot(Sg, Ppc, <span class="st">&#39;r-&#39;</span>)</span>
<span id="cb134-8"><a href="create-the-phase-diagram-plot.html#cb134-8" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BDFD1EBE0</span><span class="op">&gt;</span>]</span>
<span id="cb134-9"><a href="create-the-phase-diagram-plot.html#cb134-9" aria-hidden="true" tabindex="-1"></a>plt.plot(Sg, Tpc, <span class="st">&#39;b-&#39;</span>)</span>
<span id="cb134-10"><a href="create-the-phase-diagram-plot.html#cb134-10" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BCD8B6BB0</span><span class="op">&gt;</span>]</span>
<span id="cb134-11"><a href="create-the-phase-diagram-plot.html#cb134-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb134-12"><a href="create-the-phase-diagram-plot.html#cb134-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Pseudo-critical Pressure and Temperature (psia and R)&#39;</span>)</span>
<span id="cb134-13"><a href="create-the-phase-diagram-plot.html#cb134-13" aria-hidden="true" tabindex="-1"></a>Text(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="st">&#39;Pseudo-critical Pressure and Temperature (psia and R)&#39;</span>)</span>
<span id="cb134-14"><a href="create-the-phase-diagram-plot.html#cb134-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Gas specific gravity&#39;</span>)</span>
<span id="cb134-15"><a href="create-the-phase-diagram-plot.html#cb134-15" aria-hidden="true" tabindex="-1"></a>Text(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="st">&#39;Gas specific gravity&#39;</span>)</span>
<span id="cb134-16"><a href="create-the-phase-diagram-plot.html#cb134-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="images/pyplot-1.png" width="672" /></p>
<p>Wiechert-Aziz have developed a correlation to account for gases that contain CO2 and H2S</p>
<p><span class="math display">\[\begin{equation}
    e = 120(A^{0.9} - A^{1.6}) + 15(B^{0.5} - B^4)
\end{equation}\]</span></p>
<p>A = sum of mole fraction of H2S and CO2</p>
<p>B = sum of mole fraction of H2S</p>
<p>with this correation the modified equation becomes:</p>
<p><span class="math display" id="eq:mod">\[\begin{equation}
\tag{15.2}
    T&#39;_{pc} = T_{pc} -e \\
    P&#39;_{pc} = \frac{P_{pc}T&#39;_{pc}}{(T_{pc}- B(1-B)e)}
\end{equation}\]</span></p>
<p>Lets assume H2S mole fraction of 0.05 and CO2 mole fraction of 0.1 and compare the plots</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="create-the-phase-diagram-plot.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same code as above</span></span>
<span id="cb135-2"><a href="create-the-phase-diagram-plot.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="create-the-phase-diagram-plot.html#cb135-3" aria-hidden="true" tabindex="-1"></a>x_h2s<span class="op">=</span><span class="fl">0.05</span></span>
<span id="cb135-4"><a href="create-the-phase-diagram-plot.html#cb135-4" aria-hidden="true" tabindex="-1"></a>x_co2 <span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb135-5"><a href="create-the-phase-diagram-plot.html#cb135-5" aria-hidden="true" tabindex="-1"></a>e <span class="op">=</span> (<span class="dv">120</span> <span class="op">*</span> (((x_h2s <span class="op">+</span> x_co2)<span class="op">**</span><span class="fl">0.9</span>) <span class="op">-</span> ((x_h2s <span class="op">+</span> x_co2)<span class="op">**</span><span class="fl">1.6</span>))) <span class="op">+</span> (<span class="dv">15</span> <span class="op">*</span> (x_h2s<span class="op">**</span><span class="fl">0.5</span> <span class="op">-</span> x_h2s<span class="op">**</span><span class="dv">4</span>))</span>
<span id="cb135-6"><a href="create-the-phase-diagram-plot.html#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="create-the-phase-diagram-plot.html#cb135-7" aria-hidden="true" tabindex="-1"></a>T_pc_corr <span class="op">=</span> [T <span class="op">-</span> e <span class="cf">for</span> T <span class="kw">in</span> Tpc]</span>
<span id="cb135-8"><a href="create-the-phase-diagram-plot.html#cb135-8" aria-hidden="true" tabindex="-1"></a>P_pc_corr <span class="op">=</span> [(Ppc[i] <span class="op">*</span> T_pc_corr[i]) <span class="op">/</span> (Tpc[i] <span class="op">-</span> x_h2s <span class="op">*</span> e <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>x_h2s)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Tpc))]</span>
<span id="cb135-9"><a href="create-the-phase-diagram-plot.html#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="create-the-phase-diagram-plot.html#cb135-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb135-11"><a href="create-the-phase-diagram-plot.html#cb135-11" aria-hidden="true" tabindex="-1"></a>ax.plot(Sg, Ppc, <span class="st">&#39;r-&#39;</span>)</span>
<span id="cb135-12"><a href="create-the-phase-diagram-plot.html#cb135-12" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BE1282580</span><span class="op">&gt;</span>]</span>
<span id="cb135-13"><a href="create-the-phase-diagram-plot.html#cb135-13" aria-hidden="true" tabindex="-1"></a>ax.plot(Sg, Tpc, <span class="st">&#39;b-&#39;</span>)</span>
<span id="cb135-14"><a href="create-the-phase-diagram-plot.html#cb135-14" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BCD8A3EB0</span><span class="op">&gt;</span>]</span>
<span id="cb135-15"><a href="create-the-phase-diagram-plot.html#cb135-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-16"><a href="create-the-phase-diagram-plot.html#cb135-16" aria-hidden="true" tabindex="-1"></a>ax.plot(Sg, P_pc_corr, <span class="st">&#39;r--&#39;</span>)</span>
<span id="cb135-17"><a href="create-the-phase-diagram-plot.html#cb135-17" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BE1282BE0</span><span class="op">&gt;</span>]</span>
<span id="cb135-18"><a href="create-the-phase-diagram-plot.html#cb135-18" aria-hidden="true" tabindex="-1"></a>ax.plot(Sg, T_pc_corr, <span class="st">&#39;b--&#39;</span>)</span>
<span id="cb135-19"><a href="create-the-phase-diagram-plot.html#cb135-19" aria-hidden="true" tabindex="-1"></a>[<span class="op">&lt;</span>matplotlib.lines.Line2D <span class="bu">object</span> at <span class="bn">0x0000020BE1282CA0</span><span class="op">&gt;</span>]</span>
<span id="cb135-20"><a href="create-the-phase-diagram-plot.html#cb135-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-21"><a href="create-the-phase-diagram-plot.html#cb135-21" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb135-22"><a href="create-the-phase-diagram-plot.html#cb135-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Pseudo-critical Pressure and Temperature (psia and R)&#39;</span>)</span>
<span id="cb135-23"><a href="create-the-phase-diagram-plot.html#cb135-23" aria-hidden="true" tabindex="-1"></a>Text(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="st">&#39;Pseudo-critical Pressure and Temperature (psia and R)&#39;</span>)</span>
<span id="cb135-24"><a href="create-the-phase-diagram-plot.html#cb135-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Gas specific gravity&#39;</span>)</span>
<span id="cb135-25"><a href="create-the-phase-diagram-plot.html#cb135-25" aria-hidden="true" tabindex="-1"></a>Text(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="st">&#39;Gas specific gravity&#39;</span>)</span>
<span id="cb135-26"><a href="create-the-phase-diagram-plot.html#cb135-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="images/pyplot1-3.png" width="672" /></p>
</div>
<div id="gas-z-factor" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Gas z Factor<a href="create-the-phase-diagram-plot.html#gas-z-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The gas compressibility factor is a critical parameter in gas reservoir engineering, and below correlations provide approximations for its calculation. Please note that the accuracy of these correlations may vary depending on the specific gas mixture and conditions.</p>
<div id="dranchuk-and-aboukassem-equation-of-state" class="section level4 hasAnchor" number="15.1.2.1">
<h4><span class="header-section-number">15.1.2.1</span> Dranchuk and Aboukassem equation of state<a href="create-the-phase-diagram-plot.html#dranchuk-and-aboukassem-equation-of-state" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The form of equation is as follow:
<span class="math display" id="eq:Dranchuk">\[\begin{equation}
\begin{split}
    
    z = 1 + c_{1}(T_{pr}) p_{r} + c_{2}(T_{pr})p_{r}^2 - c_{3}(T_{pr})p_{r}^5 + c_{4}(T_{pr}p_{r})  \\
    where : \\
p_{r} = 0.27 P_{pr}/(zT_{pr}) \\
c_{1}(T_{pr})  = A_{1} + A_{2}/T_{pr} + A_{3}/T_{pr}^3 + A_{4}/T_{pr}^4 + A_{5}/T_{pr}^5\\
c_{2}(T_{pr})  = A_{6} + A_{7}/T_{pr} + A_{8}/T_{pr}^2 \\
c_{3}(T_{pr})  = A_{9}(A_{7}/T_{pr} + A_{8}/T_{pr}^2) \\
c_{4}(T_{pr}p_{r})  = A_{10}( 1 + A_{11}p_{r}^2)(p_{r}^2/T_{pr}^3) exp(-A_{11}p_{r}^2) \\


\end{split}
\tag{15.3}
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{equation}
A_{1} = 0.3265; A_{2} = -1.0700; A_{3} = -0.5339; A_{4} = 0.01569; A_{5} = -0.05165; A_{6} = 0.5475 \\
A_{7} = -0.7361; A_{8} = 0.1844; A_{9} = 0.1056; A_{10} = 0.6134; A_{11} = 0.7210
\end{equation}\]</span></p>
<p>The above equation has z-factor on both side of the equation. To solve such equation a trial and error solution is required. However, in Python we can solve this equation using <code>fsolve</code> function of <code>scipy</code> library, which is a non-linear solver.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="create-the-phase-diagram-plot.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb136-2"><a href="create-the-phase-diagram-plot.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> fsolve <span class="co"># non-linear solver</span></span>
<span id="cb136-3"><a href="create-the-phase-diagram-plot.html#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="create-the-phase-diagram-plot.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getZ_dranchuk(T_pr, P_pr):</span>
<span id="cb136-5"><a href="create-the-phase-diagram-plot.html#cb136-5" aria-hidden="true" tabindex="-1"></a>    a1 <span class="op">=</span> <span class="fl">0.3265</span><span class="op">;</span> a2 <span class="op">=</span> <span class="op">-</span><span class="fl">1.0700</span><span class="op">;</span> a3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.5339</span><span class="op">;</span> a4 <span class="op">=</span> <span class="fl">0.01569</span><span class="op">;</span> a5 <span class="op">=</span> <span class="op">-</span><span class="fl">0.05165</span><span class="op">;</span> a6 <span class="op">=</span> <span class="fl">0.5475</span></span>
<span id="cb136-6"><a href="create-the-phase-diagram-plot.html#cb136-6" aria-hidden="true" tabindex="-1"></a>    a7 <span class="op">=</span> <span class="op">-</span><span class="fl">0.7361</span><span class="op">;</span> a8 <span class="op">=</span> <span class="fl">0.1844</span><span class="op">;</span> a9 <span class="op">=</span> <span class="fl">0.1056</span><span class="op">;</span> a10 <span class="op">=</span> <span class="fl">0.6134</span><span class="op">;</span> a11 <span class="op">=</span> <span class="fl">0.7210</span></span>
<span id="cb136-7"><a href="create-the-phase-diagram-plot.html#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> func(y):</span>
<span id="cb136-8"><a href="create-the-phase-diagram-plot.html#cb136-8" aria-hidden="true" tabindex="-1"></a>        rho_pr, z <span class="op">=</span> y</span>
<span id="cb136-9"><a href="create-the-phase-diagram-plot.html#cb136-9" aria-hidden="true" tabindex="-1"></a>        c1 <span class="op">=</span> a1 <span class="op">+</span> (a2<span class="op">/</span>T_pr) <span class="op">+</span> (a3<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">3</span>))<span class="op">+</span> (a4<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">4</span>))<span class="op">+</span> (a5<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">5</span>))</span>
<span id="cb136-10"><a href="create-the-phase-diagram-plot.html#cb136-10" aria-hidden="true" tabindex="-1"></a>        c2 <span class="op">=</span> a6 <span class="op">+</span> (a7<span class="op">/</span>T_pr) <span class="op">+</span> (a8<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb136-11"><a href="create-the-phase-diagram-plot.html#cb136-11" aria-hidden="true" tabindex="-1"></a>        c3 <span class="op">=</span> a9<span class="op">*</span>((a7<span class="op">/</span>T_pr) <span class="op">+</span> (a8<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">2</span>)))</span>
<span id="cb136-12"><a href="create-the-phase-diagram-plot.html#cb136-12" aria-hidden="true" tabindex="-1"></a>        c4 <span class="op">=</span> (a10)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(a11<span class="op">*</span>(rho_pr<span class="op">**</span><span class="dv">2</span>)))<span class="op">*</span>((rho_pr<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(T_pr<span class="op">**</span><span class="dv">3</span>))<span class="op">*</span>(np.exp(<span class="op">-</span>a11<span class="op">*</span>(rho_pr<span class="op">**</span><span class="dv">2</span>)))</span>
<span id="cb136-13"><a href="create-the-phase-diagram-plot.html#cb136-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-14"><a href="create-the-phase-diagram-plot.html#cb136-14" aria-hidden="true" tabindex="-1"></a>        f1 <span class="op">=</span> z <span class="op">+</span> (c3<span class="op">*</span>(rho_pr<span class="op">**</span><span class="dv">5</span>)) <span class="op">-</span> (c2<span class="op">*</span>(rho_pr<span class="op">**</span><span class="dv">2</span>)) <span class="op">-</span> (c1<span class="op">*</span>(rho_pr<span class="op">**</span><span class="dv">1</span>)) <span class="op">-</span> c4 <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb136-15"><a href="create-the-phase-diagram-plot.html#cb136-15" aria-hidden="true" tabindex="-1"></a>        f2 <span class="op">=</span> rho_pr <span class="op">-</span> ((<span class="fl">0.27</span> <span class="op">*</span> P_pr) <span class="op">/</span> (z <span class="op">*</span> T_pr))</span>
<span id="cb136-16"><a href="create-the-phase-diagram-plot.html#cb136-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>[f1, f2]</span>
<span id="cb136-17"><a href="create-the-phase-diagram-plot.html#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="create-the-phase-diagram-plot.html#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dranchuk():</span>
<span id="cb136-19"><a href="create-the-phase-diagram-plot.html#cb136-19" aria-hidden="true" tabindex="-1"></a>        solve <span class="op">=</span> fsolve(func, [<span class="dv">1</span>, <span class="dv">1</span>]) <span class="co"># initial guess</span></span>
<span id="cb136-20"><a href="create-the-phase-diagram-plot.html#cb136-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(solve[<span class="dv">0</span>], solve[<span class="dv">1</span>]) </span>
<span id="cb136-21"><a href="create-the-phase-diagram-plot.html#cb136-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-22"><a href="create-the-phase-diagram-plot.html#cb136-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dranchuk()[<span class="dv">1</span>]</span>
<span id="cb136-23"><a href="create-the-phase-diagram-plot.html#cb136-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-24"><a href="create-the-phase-diagram-plot.html#cb136-24" aria-hidden="true" tabindex="-1"></a><span class="co"># lets Assume </span></span>
<span id="cb136-25"><a href="create-the-phase-diagram-plot.html#cb136-25" aria-hidden="true" tabindex="-1"></a>T_pr <span class="op">=</span> <span class="fl">1.8</span></span>
<span id="cb136-26"><a href="create-the-phase-diagram-plot.html#cb136-26" aria-hidden="true" tabindex="-1"></a>P_pr <span class="op">=</span> <span class="fl">4.87</span></span>
<span id="cb136-27"><a href="create-the-phase-diagram-plot.html#cb136-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-28"><a href="create-the-phase-diagram-plot.html#cb136-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Gas Deviation factor Z : = </span><span class="sc">{</span>getZ_dranchuk(T_pr, P_pr)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb136-29"><a href="create-the-phase-diagram-plot.html#cb136-29" aria-hidden="true" tabindex="-1"></a>Gas Deviation factor Z : <span class="op">=</span> <span class="fl">0.9110107290176761</span></span></code></pre></div>
</div>
<div id="standing-katz-correlation" class="section level4 hasAnchor" number="15.1.2.2">
<h4><span class="header-section-number">15.1.2.2</span> Standing-Katz Correlation<a href="create-the-phase-diagram-plot.html#standing-katz-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Standing-Katz correlation provides an empirical estimation of the gas compressibility factor (Z) for natural gases. It is based on a set of constants and the deviation factor (F) for the gas:</p>
<p><span class="math display">\[ Z = 1 + \left(\frac{0.27}{P}\right) \cdot F \]</span></p>
<p>Where:
- <span class="math inline">\(P\)</span> is the pressure in psia (pounds per square inch absolute).
- <span class="math inline">\(F\)</span> is the deviation factor calculated based on the specific gravity (SG) of the gas.</p>
<p>Here’s Python code to calculate Z using the Standing-Katz correlation:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="create-the-phase-diagram-plot.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Standing-Katz correlation</span></span>
<span id="cb137-2"><a href="create-the-phase-diagram-plot.html#cb137-2" aria-hidden="true" tabindex="-1"></a>P_psia <span class="op">=</span> <span class="fl">1450.0</span>  <span class="co"># Pressure in psia</span></span>
<span id="cb137-3"><a href="create-the-phase-diagram-plot.html#cb137-3" aria-hidden="true" tabindex="-1"></a>SG <span class="op">=</span> <span class="fl">0.75</span>  <span class="co"># Specific gravity of the gas</span></span>
<span id="cb137-4"><a href="create-the-phase-diagram-plot.html#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="create-the-phase-diagram-plot.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the deviation factor F based on SG</span></span>
<span id="cb137-6"><a href="create-the-phase-diagram-plot.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> SG <span class="op">&lt;</span> <span class="fl">0.6</span>:</span>
<span id="cb137-7"><a href="create-the-phase-diagram-plot.html#cb137-7" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fl">0.933</span> <span class="op">+</span> <span class="fl">0.1395</span> <span class="op">*</span> SG <span class="op">+</span> <span class="fl">0.0167</span> <span class="op">*</span> SG<span class="op">**</span><span class="dv">2</span></span>
<span id="cb137-8"><a href="create-the-phase-diagram-plot.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb137-9"><a href="create-the-phase-diagram-plot.html#cb137-9" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fl">0.315</span> <span class="op">+</span> <span class="fl">0.622</span> <span class="op">*</span> SG <span class="op">-</span> <span class="fl">0.216</span> <span class="op">*</span> SG<span class="op">**</span><span class="dv">2</span></span>
<span id="cb137-10"><a href="create-the-phase-diagram-plot.html#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="create-the-phase-diagram-plot.html#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Z using the Standing-Katz correlation</span></span>
<span id="cb137-12"><a href="create-the-phase-diagram-plot.html#cb137-12" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> (<span class="fl">0.27</span> <span class="op">/</span> P_psia) <span class="op">*</span> F</span>
<span id="cb137-13"><a href="create-the-phase-diagram-plot.html#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="create-the-phase-diagram-plot.html#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Gas Compressibility Factor (Z) using Standing-Katz Correlation: </span><span class="sc">{Z}</span><span class="ss">&quot;</span>)</span></code></pre></div>
</div>
<div id="carr-rossi-lopez-correlation" class="section level4 hasAnchor" number="15.1.2.3">
<h4><span class="header-section-number">15.1.2.3</span> Carr-Rossi-Lopez Correlation<a href="create-the-phase-diagram-plot.html#carr-rossi-lopez-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Carr-Rossi-Lopez (CRL) correlation provides an empirical estimation of the gas compressibility factor (Z) for natural gases. It uses a set of constants and the deviation factor (F) for the gas:</p>
<p><span class="math display">\[ Z = 1 + \left(\frac{0.1}{P}\right) \cdot F \]</span></p>
<p>Where:
- <span class="math inline">\(P\)</span> is the pressure in psia (pounds per square inch absolute).
- <span class="math inline">\(F\)</span> is the deviation factor calculated based on the specific gravity (SG) of the gas.</p>
<p>Here’s Python code to calculate Z using the Carr-Rossi-Lopez (CRL) correlation:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="create-the-phase-diagram-plot.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Carr-Rossi-Lopez (CRL) correlation</span></span>
<span id="cb138-2"><a href="create-the-phase-diagram-plot.html#cb138-2" aria-hidden="true" tabindex="-1"></a>P_psia <span class="op">=</span> <span class="fl">1450.0</span>  <span class="co"># Pressure in psia</span></span>
<span id="cb138-3"><a href="create-the-phase-diagram-plot.html#cb138-3" aria-hidden="true" tabindex="-1"></a>SG <span class="op">=</span> <span class="fl">0.85</span>  <span class="co"># Specific gravity of the gas</span></span>
<span id="cb138-4"><a href="create-the-phase-diagram-plot.html#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="create-the-phase-diagram-plot.html#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the deviation factor F based on SG</span></span>
<span id="cb138-6"><a href="create-the-phase-diagram-plot.html#cb138-6" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> <span class="fl">0.91</span> <span class="op">+</span> <span class="fl">0.105</span> <span class="op">*</span> SG</span>
<span id="cb138-7"><a href="create-the-phase-diagram-plot.html#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="create-the-phase-diagram-plot.html#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Z using the Carr-Rossi-Lopez (CRL) correlation</span></span>
<span id="cb138-9"><a href="create-the-phase-diagram-plot.html#cb138-9" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> (<span class="fl">0.1</span> <span class="op">/</span> P_psia) <span class="op">*</span> F</span>
<span id="cb138-10"><a href="create-the-phase-diagram-plot.html#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="create-the-phase-diagram-plot.html#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Gas Compressibility Factor (Z) using Carr-Rossi-Lopez (CRL) Correlation: </span><span class="sc">{Z}</span><span class="ss">&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="gas-density" class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Gas Density<a href="create-the-phase-diagram-plot.html#gas-density" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Density of a real gas can be calculated using the formula given below:
<span class="math display" id="eq:gasDensity">\[\begin{equation}
    \tag{15.4}
    \rho_g  = \frac{1}{v} = \frac{pM_a}{zRT}
\end{equation}\]</span></p>
<p>Using the data in below assuming real gas behavior, let’s calculate the density of the gas phase under initial reservoir conditions.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="create-the-phase-diagram-plot.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Component [CO2, N2, C1, C2, C3, i-C4, n-c4]</span></span>
<span id="cb139-2"><a href="create-the-phase-diagram-plot.html#cb139-2" aria-hidden="true" tabindex="-1"></a>gasComposition <span class="op">=</span> [<span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.85</span>, <span class="fl">0.04</span>, <span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>]</span>
<span id="cb139-3"><a href="create-the-phase-diagram-plot.html#cb139-3" aria-hidden="true" tabindex="-1"></a>MW <span class="op">=</span> [<span class="fl">44.01</span>, <span class="fl">28.01</span>, <span class="fl">16.04</span>, <span class="fl">30.1</span>, <span class="fl">44.1</span>, <span class="fl">58.1</span>, <span class="fl">58.1</span>]</span>
<span id="cb139-4"><a href="create-the-phase-diagram-plot.html#cb139-4" aria-hidden="true" tabindex="-1"></a>Tc <span class="op">=</span> [<span class="fl">547.91</span>, <span class="fl">227.49</span> , <span class="fl">343.33</span>, <span class="fl">549.92</span>, <span class="fl">666.06</span>, <span class="fl">734.46</span>, <span class="fl">765.62</span>] <span class="co">#Rankine</span></span>
<span id="cb139-5"><a href="create-the-phase-diagram-plot.html#cb139-5" aria-hidden="true" tabindex="-1"></a>Pc <span class="op">=</span> [<span class="dv">1071</span>, <span class="fl">493.1</span>, <span class="fl">666.4</span>, <span class="fl">706.5</span>, <span class="fl">616.4</span>, <span class="fl">527.9</span>, <span class="fl">550.6</span>]</span>
<span id="cb139-6"><a href="create-the-phase-diagram-plot.html#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="create-the-phase-diagram-plot.html#cb139-7" aria-hidden="true" tabindex="-1"></a>Ma <span class="op">=</span> <span class="bu">sum</span>([y<span class="op">*</span>M <span class="cf">for</span> y, M <span class="kw">in</span> <span class="bu">zip</span>(gasComposition, MW)])</span>
<span id="cb139-8"><a href="create-the-phase-diagram-plot.html#cb139-8" aria-hidden="true" tabindex="-1"></a>Tpc <span class="op">=</span> <span class="bu">sum</span>([y<span class="op">*</span>T <span class="cf">for</span> y, T <span class="kw">in</span> <span class="bu">zip</span>(gasComposition, Tc)])</span>
<span id="cb139-9"><a href="create-the-phase-diagram-plot.html#cb139-9" aria-hidden="true" tabindex="-1"></a>Ppc <span class="op">=</span> <span class="bu">sum</span>([y<span class="op">*</span>P <span class="cf">for</span> y, P <span class="kw">in</span> <span class="bu">zip</span>(gasComposition, Pc)])</span>
<span id="cb139-10"><a href="create-the-phase-diagram-plot.html#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="create-the-phase-diagram-plot.html#cb139-11" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="dv">3000</span> <span class="co"># Reservoir Pressure in psi</span></span>
<span id="cb139-12"><a href="create-the-phase-diagram-plot.html#cb139-12" aria-hidden="true" tabindex="-1"></a>T  <span class="op">=</span> <span class="dv">640</span> <span class="co"># Reservoir Temperature in R</span></span>
<span id="cb139-13"><a href="create-the-phase-diagram-plot.html#cb139-13" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fl">10.73</span> <span class="co">#</span></span>
<span id="cb139-14"><a href="create-the-phase-diagram-plot.html#cb139-14" aria-hidden="true" tabindex="-1"></a>T_pr <span class="op">=</span> T<span class="op">/</span>Tpc</span>
<span id="cb139-15"><a href="create-the-phase-diagram-plot.html#cb139-15" aria-hidden="true" tabindex="-1"></a>P_pr <span class="op">=</span> P<span class="op">/</span>Ppc</span>
<span id="cb139-16"><a href="create-the-phase-diagram-plot.html#cb139-16" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> getZ_dranchuk(T_pr, P_pr)</span>
<span id="cb139-17"><a href="create-the-phase-diagram-plot.html#cb139-17" aria-hidden="true" tabindex="-1"></a>density <span class="op">=</span> P<span class="op">*</span>Ma<span class="op">/</span>(Z<span class="op">*</span>R<span class="op">*</span>T)</span>
<span id="cb139-18"><a href="create-the-phase-diagram-plot.html#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="create-the-phase-diagram-plot.html#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb139-20"><a href="create-the-phase-diagram-plot.html#cb139-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb139-21"><a href="create-the-phase-diagram-plot.html#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="op">--------------------------------------------------</span></span>
<span id="cb139-22"><a href="create-the-phase-diagram-plot.html#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Apparent molecular weight : = </span><span class="sc">{</span><span class="bu">round</span>(Ma, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb139-23"><a href="create-the-phase-diagram-plot.html#cb139-23" aria-hidden="true" tabindex="-1"></a>Apparent molecular weight : <span class="op">=</span> <span class="fl">20.23</span></span>
<span id="cb139-24"><a href="create-the-phase-diagram-plot.html#cb139-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Pseudo-critical pressure : = </span><span class="sc">{</span><span class="bu">round</span>(Ppc, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> psi&#39;</span>)</span>
<span id="cb139-25"><a href="create-the-phase-diagram-plot.html#cb139-25" aria-hidden="true" tabindex="-1"></a>Pseudo<span class="op">-</span>critical pressure : <span class="op">=</span> <span class="fl">666.39</span> psi</span>
<span id="cb139-26"><a href="create-the-phase-diagram-plot.html#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Pseudo-critical temperature : = </span><span class="sc">{</span><span class="bu">round</span>(Tpc, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> R&#39;</span>)</span>
<span id="cb139-27"><a href="create-the-phase-diagram-plot.html#cb139-27" aria-hidden="true" tabindex="-1"></a>Pseudo<span class="op">-</span>critical temperature : <span class="op">=</span> <span class="fl">384.39</span> R</span>
<span id="cb139-28"><a href="create-the-phase-diagram-plot.html#cb139-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Pseudo-reduced pressure : = </span><span class="sc">{</span><span class="bu">round</span>(P_pr, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb139-29"><a href="create-the-phase-diagram-plot.html#cb139-29" aria-hidden="true" tabindex="-1"></a>Pseudo<span class="op">-</span>reduced pressure : <span class="op">=</span> <span class="fl">4.5</span></span>
<span id="cb139-30"><a href="create-the-phase-diagram-plot.html#cb139-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Pseudo-reduced temperature : = </span><span class="sc">{</span><span class="bu">round</span>(T_pr, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb139-31"><a href="create-the-phase-diagram-plot.html#cb139-31" aria-hidden="true" tabindex="-1"></a>Pseudo<span class="op">-</span>reduced temperature : <span class="op">=</span> <span class="fl">1.66</span></span>
<span id="cb139-32"><a href="create-the-phase-diagram-plot.html#cb139-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Gas Deviation factor : = </span><span class="sc">{</span><span class="bu">round</span>(Z, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb139-33"><a href="create-the-phase-diagram-plot.html#cb139-33" aria-hidden="true" tabindex="-1"></a>Gas Deviation factor : <span class="op">=</span> <span class="fl">0.86</span></span>
<span id="cb139-34"><a href="create-the-phase-diagram-plot.html#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Gas Density : = </span><span class="sc">{</span><span class="bu">round</span>(density, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> lb/ft3&#39;</span>)</span>
<span id="cb139-35"><a href="create-the-phase-diagram-plot.html#cb139-35" aria-hidden="true" tabindex="-1"></a>Gas Density : <span class="op">=</span> <span class="fl">10.28</span> lb<span class="op">/</span>ft3</span></code></pre></div>
<div id="benedict-webb-rubin-bwr-equation-of-state" class="section level4 hasAnchor" number="15.1.3.1">
<h4><span class="header-section-number">15.1.3.1</span> Benedict-Webb-Rubin (BWR) Equation of State<a href="create-the-phase-diagram-plot.html#benedict-webb-rubin-bwr-equation-of-state" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Benedict-Webb-Rubin (BWR) equation of state is a comprehensive model to estimate gas density (ρ) considering real gas behavior. The equation is quite complex and involves numerous constants and terms. It is often used in software packages designed for reservoir engineering simulations.</p>
<p>The BWR equation of state for gas density (ρ) is:</p>
<p><span class="math display">\[ \rho = \frac{0.27 P}{ZRT} \left(1 + \frac{Tc}{T} \left(\frac{dZ}{dT}\right)_P\right) \]</span></p>
<p>Where:
- <span class="math inline">\(\rho\)</span> is the gas density.
- <span class="math inline">\(P\)</span> is the pressure.
- <span class="math inline">\(Z\)</span> is the gas compressibility factor.
- <span class="math inline">\(R\)</span> is the gas constant.
- <span class="math inline">\(T\)</span> is the absolute temperature.
- <span class="math inline">\(Tc\)</span> is the critical temperature.
- <span class="math inline">\(\left(\frac{dZ}{dT}\right)_P\)</span> is the derivative of the compressibility factor with respect to temperature at constant pressure.</p>
<p>Calculating <span class="math inline">\(\left(\frac{dZ}{dT}\right)_P\)</span> involves a complex iterative process and is typically done using specialized software.</p>
<p>Due to its complexity, engineers often rely on software or reservoir simulators to apply the BWR equation of state.</p>
<div id="standing-katz-equation" class="section level5 hasAnchor" number="15.1.3.1.1">
<h5><span class="header-section-number">15.1.3.1.1</span> Standing-Katz Equation<a href="create-the-phase-diagram-plot.html#standing-katz-equation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Standing-Katz equation offers an empirical estimate of gas density (ρ) based on the gas compressibility factor (Z):</p>
<p><span class="math display">\[ \rho = \frac{0.00277 Z M}{T} \]</span></p>
<p>Where:
- <span class="math inline">\(\rho\)</span> is the gas density.
- <span class="math inline">\(Z\)</span> is the gas compressibility factor.
- <span class="math inline">\(M\)</span> is the molecular weight of the gas.
- <span class="math inline">\(T\)</span> is the absolute temperature.</p>
<p>Here’s Python code to calculate ρ using the Standing-Katz equation:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="create-the-phase-diagram-plot.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Standing-Katz equation</span></span>
<span id="cb140-2"><a href="create-the-phase-diagram-plot.html#cb140-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="fl">0.95</span>  <span class="co"># Compressibility factor</span></span>
<span id="cb140-3"><a href="create-the-phase-diagram-plot.html#cb140-3" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">28.97</span>  <span class="co"># Molecular weight of nitrogen (for example)</span></span>
<span id="cb140-4"><a href="create-the-phase-diagram-plot.html#cb140-4" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">273.15</span>  <span class="co"># Temperature in K</span></span>
<span id="cb140-5"><a href="create-the-phase-diagram-plot.html#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="create-the-phase-diagram-plot.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ρ using the Standing-Katz equation</span></span>
<span id="cb140-7"><a href="create-the-phase-diagram-plot.html#cb140-7" aria-hidden="true" tabindex="-1"></a>rho <span class="op">=</span> (<span class="fl">0.00277</span> <span class="op">*</span> Z <span class="op">*</span> M) <span class="op">/</span> T</span>
<span id="cb140-8"><a href="create-the-phase-diagram-plot.html#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="create-the-phase-diagram-plot.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Gas Density (ρ) using Standing-Katz Equation: </span><span class="sc">{</span>rho<span class="sc">}</span><span class="ss"> g/L&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="correlation-5-papps-equation" class="section level4 hasAnchor" number="15.1.3.2">
<h4><span class="header-section-number">15.1.3.2</span> Correlation 5: Papp’s Equation<a href="create-the-phase-diagram-plot.html#correlation-5-papps-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Papp’s equation offers an empirical estimate of gas density (ρ) based on gas-specific parameters:</p>
<p><span class="math display">\[ \rho = \frac{Z \cdot M}{T \cdot 10^{6} \cdot P} \]</span></p>
<p>Where:
- <span class="math inline">\(\rho\)</span> is the gas density.
- <span class="math inline">\(Z\)</span> is the gas compressibility factor.
- <span class="math inline">\(M\)</span> is the molecular weight of the gas.
- <span class="math inline">\(T\)</span> is the absolute temperature.
- <span class="math inline">\(P\)</span> is the pressure in psia.</p>
<p>Here’s Python code to calculate ρ using Papp’s equation:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="create-the-phase-diagram-plot.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for Papp&#39;s equation</span></span>
<span id="cb141-2"><a href="create-the-phase-diagram-plot.html#cb141-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="fl">0.95</span>  <span class="co"># Compressibility factor</span></span>
<span id="cb141-3"><a href="create-the-phase-diagram-plot.html#cb141-3" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="fl">28.97</span>  <span class="co"># Molecular weight of nitrogen (for example)</span></span>
<span id="cb141-4"><a href="create-the-phase-diagram-plot.html#cb141-4" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">273.15</span>  <span class="co"># Temperature in K</span></span>
<span id="cb141-5"><a href="create-the-phase-diagram-plot.html#cb141-5" aria-hidden="true" tabindex="-1"></a>P_psia <span class="op">=</span> <span class="fl">14.5</span>  <span class="co"># Pressure in psia</span></span>
<span id="cb141-6"><a href="create-the-phase-diagram-plot.html#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="create-the-phase-diagram-plot.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ρ using Papp&#39;s equation</span></span>
<span id="cb141-8"><a href="create-the-phase-diagram-plot.html#cb141-8" aria-hidden="true" tabindex="-1"></a>rho <span class="op">=</span> (Z <span class="op">*</span> M) <span class="op">/</span> (T <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">6</span> <span class="op">*</span> P_psia)</span>
<span id="cb141-9"><a href="create-the-phase-diagram-plot.html#cb141-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-10"><a href="create-the-phase-diagram-plot.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Gas Density (ρ) using Papp&#39;s Equation: </span><span class="sc">{</span>rho<span class="sc">}</span><span class="ss"> g/L&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="isothermal-gas-compressibility" class="section level3 hasAnchor" number="15.1.4">
<h3><span class="header-section-number">15.1.4</span> Isothermal Gas Compressibility<a href="create-the-phase-diagram-plot.html#isothermal-gas-compressibility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Isothermal compressibility is defined as change in volume with pressure for gas under isothermal condition.</p>
<p><span class="math display" id="eq:compress">\[\begin{equation}
    \tag{15.5}
    V = znR&#39;T/P  \\
    or  \\ V = constant * z/P 
\end{equation}\]</span></p>
<p>Mattar, Brar, and Aziz developed an analytical expression for calculating pseudo-reduced compressibility.</p>
<p><img src="./images/isothermal-compressibility_1.JPG" /></p>
<p>By taking the derivative of equation of state developed by Dranchuck and Abou-Kassem developed the following equation.
<img src="./images/isothermal-compressibility_2.JPG" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="create-the-phase-diagram-plot.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code for Isothermal Gas Compressibility using Dranchuck and Abou-Kassem equation</span></span>
<span id="cb142-2"><a href="create-the-phase-diagram-plot.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb142-3"><a href="create-the-phase-diagram-plot.html#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="create-the-phase-diagram-plot.html#cb142-4" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> <span class="fl">0.3265</span><span class="op">;</span> a2 <span class="op">=</span> <span class="op">-</span><span class="fl">1.0700</span><span class="op">;</span> a3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.5339</span><span class="op">;</span> a4 <span class="op">=</span> <span class="fl">0.01569</span><span class="op">;</span> a5 <span class="op">=</span> <span class="op">-</span><span class="fl">0.05165</span><span class="op">;</span> a6 <span class="op">=</span> <span class="fl">0.5475</span></span>
<span id="cb142-5"><a href="create-the-phase-diagram-plot.html#cb142-5" aria-hidden="true" tabindex="-1"></a>a7 <span class="op">=</span> <span class="op">-</span><span class="fl">0.7361</span><span class="op">;</span> a8 <span class="op">=</span> <span class="fl">0.1844</span><span class="op">;</span> a9 <span class="op">=</span> <span class="fl">0.1056</span><span class="op">;</span> a10 <span class="op">=</span> <span class="fl">0.6134</span><span class="op">;</span> a11 <span class="op">=</span> <span class="fl">0.7210</span></span>
<span id="cb142-6"><a href="create-the-phase-diagram-plot.html#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="create-the-phase-diagram-plot.html#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mattar(T_pr, P_pr, rho_pr, z, P_pc_corr):</span>
<span id="cb142-8"><a href="create-the-phase-diagram-plot.html#cb142-8" aria-hidden="true" tabindex="-1"></a>    do <span class="op">=</span> ((a1 <span class="op">+</span> (a2<span class="op">/</span>T_pr) <span class="op">+</span> (a3<span class="op">/</span>T_pr<span class="op">**</span><span class="dv">3</span>) <span class="op">+</span>(a4<span class="op">/</span>T_pr<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> (a5<span class="op">/</span>T_pr<span class="op">**</span><span class="dv">5</span>)) <span class="op">*</span> rho_pr) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb142-9"><a href="create-the-phase-diagram-plot.html#cb142-9" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">2</span> <span class="op">*</span> ((a6 <span class="op">+</span> (a7<span class="op">/</span>T_pr) <span class="op">+</span> (a8<span class="op">/</span>T_pr<span class="op">**</span><span class="dv">2</span>))) <span class="op">*</span> rho_pr<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="op">\</span></span>
<span id="cb142-10"><a href="create-the-phase-diagram-plot.html#cb142-10" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">5</span> <span class="op">*</span> a9 <span class="op">*</span> (((a7<span class="op">/</span>T_pr) <span class="op">+</span> (a8<span class="op">/</span>T_pr<span class="op">**</span><span class="dv">2</span>))) <span class="op">*</span> rho_pr<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> (<span class="dv">1</span> <span class="op">+</span> (a11 <span class="op">*</span> rho_pr<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> (a11 <span class="op">*</span> rho_pr<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">\</span></span>
<span id="cb142-11"><a href="create-the-phase-diagram-plot.html#cb142-11" aria-hidden="true" tabindex="-1"></a>      <span class="op">*</span> ((<span class="dv">2</span> <span class="op">*</span> a10 <span class="op">*</span> rho_pr <span class="op">/</span> T_pr<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>np.exp(<span class="op">-</span>a11 <span class="op">*</span> rho_pr<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb142-12"><a href="create-the-phase-diagram-plot.html#cb142-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-13"><a href="create-the-phase-diagram-plot.html#cb142-13" aria-hidden="true" tabindex="-1"></a>    c_pr_analytical <span class="op">=</span> (<span class="dv">1</span> <span class="op">/</span> P_pr) <span class="op">-</span> ((<span class="fl">0.27</span> <span class="op">/</span> (z<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> T_pr)) <span class="op">*</span> (do <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> ((rho_pr <span class="op">/</span> z) <span class="op">*</span> do))))</span>
<span id="cb142-14"><a href="create-the-phase-diagram-plot.html#cb142-14" aria-hidden="true" tabindex="-1"></a>    cgas_analytical <span class="op">=</span> c_pr_analytical <span class="op">/</span> P_pc_corr</span>
<span id="cb142-15"><a href="create-the-phase-diagram-plot.html#cb142-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(cgas_analytical)</span>
<span id="cb142-16"><a href="create-the-phase-diagram-plot.html#cb142-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-17"><a href="create-the-phase-diagram-plot.html#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mattar(<span class="fl">1.44</span>, <span class="fl">7.08</span>, <span class="fl">0.80</span>, <span class="fl">0.91</span>, <span class="dv">636</span>))</span>
<span id="cb142-18"><a href="create-the-phase-diagram-plot.html#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00021157987661567598</span></span></code></pre></div>
</div>
<div id="gas-formation-volume-factor" class="section level3 hasAnchor" number="15.1.5">
<h3><span class="header-section-number">15.1.5</span> Gas formation volume factor<a href="create-the-phase-diagram-plot.html#gas-formation-volume-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ideal-gas-law-1" class="section level4 hasAnchor" number="15.1.5.1">
<h4><span class="header-section-number">15.1.5.1</span> Ideal Gas Law<a href="create-the-phase-diagram-plot.html#ideal-gas-law-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The ideal gas law offers a simple estimate of the gas formation volume factor (Bg) assuming ideal gas behavior:</p>
<p><span class="math display">\[ Bg = \frac{1}{Z} \]</span></p>
<p>Where:
- <span class="math inline">\(Bg\)</span> is the gas formation volume factor.
- <span class="math inline">\(Z\)</span> is the gas compressibility factor.</p>
<p>Here’s Python code to calculate Bg using the ideal gas law:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="create-the-phase-diagram-plot.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for ideal gas law</span></span>
<span id="cb143-2"><a href="create-the-phase-diagram-plot.html#cb143-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="fl">0.95</span>  <span class="co"># Compressibility factor</span></span>
<span id="cb143-3"><a href="create-the-phase-diagram-plot.html#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="create-the-phase-diagram-plot.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Bg using the ideal gas law</span></span>
<span id="cb143-5"><a href="create-the-phase-diagram-plot.html#cb143-5" aria-hidden="true" tabindex="-1"></a>Bg <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> Z</span>
<span id="cb143-6"><a href="create-the-phase-diagram-plot.html#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="create-the-phase-diagram-plot.html#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Estimated Gas Formation Volume Factor (Bg) using Ideal Gas Law: </span><span class="sc">{Bg}</span><span class="ss"> RB/STB&quot;</span>)</span></code></pre></div>
</div>
<div id="real-gas-law-1" class="section level4 hasAnchor" number="15.1.5.2">
<h4><span class="header-section-number">15.1.5.2</span> Real Gas Law<a href="create-the-phase-diagram-plot.html#real-gas-law-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Gas formation volume factor relates the volume of gas in the reservoir to the volume of gas on the surface at standard conditions
so, Bg can be written as Bg = 0.02829 zT/p in ft3/scf = 0.00504 zT/P bbl/scf.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="create-the-phase-diagram-plot.html#cb144-1" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span> <span class="fl">0.91</span></span>
<span id="cb144-2"><a href="create-the-phase-diagram-plot.html#cb144-2" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="dv">3250</span> <span class="co"># psia</span></span>
<span id="cb144-3"><a href="create-the-phase-diagram-plot.html#cb144-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">213</span> <span class="co"># F</span></span>
<span id="cb144-4"><a href="create-the-phase-diagram-plot.html#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="create-the-phase-diagram-plot.html#cb144-5" aria-hidden="true" tabindex="-1"></a>Bg <span class="op">=</span>  <span class="fl">0.02829</span><span class="op">*</span>z<span class="op">*</span>(T<span class="op">+</span><span class="dv">460</span>)<span class="op">/</span>P</span>
<span id="cb144-6"><a href="create-the-phase-diagram-plot.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="ss">f&#39;Gas formation volume Factor : </span><span class="sc">{Bg}</span><span class="ss">&#39;</span>)</span>
<span id="cb144-7"><a href="create-the-phase-diagram-plot.html#cb144-7" aria-hidden="true" tabindex="-1"></a>Gas formation volume Factor : <span class="fl">0.005330967600000001</span></span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="this-equation-assumes-constant-enthalpy-of-vaporization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="properties-of-oil.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
