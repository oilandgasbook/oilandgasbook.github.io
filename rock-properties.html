<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Rock Properties | Basic Reservoir Engineering in Python</title>
  <meta name="description" content="11 Rock Properties | Basic Reservoir Engineering in Python" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Rock Properties | Basic Reservoir Engineering in Python" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Rock Properties | Basic Reservoir Engineering in Python" />
  
  
  

<meta name="author" content="Pramod Azad" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="properties-of-oil.html"/>
<link rel="next" href="pattern-floods.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> License</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#getting-started-with-python"><i class="fa fa-check"></i><b>2.1</b> Getting Started with Python</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#datatypes"><i class="fa fa-check"></i><b>2.1.1</b> Datatypes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#lists"><i class="fa fa-check"></i><b>2.2</b> Lists</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#list-comprehensions"><i class="fa fa-check"></i><b>2.3</b> List comprehensions</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#tuples"><i class="fa fa-check"></i><b>2.4</b> Tuples</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#dictionaries"><i class="fa fa-check"></i><b>2.5</b> Dictionaries</a></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#set"><i class="fa fa-check"></i><b>2.6</b> Set</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-mathematics.html"><a href="simple-mathematics.html"><i class="fa fa-check"></i><b>3</b> Simple Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-mathematics.html"><a href="simple-mathematics.html#comparisons"><i class="fa fa-check"></i><b>3.1</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>4</b> Conditionals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="conditionals.html"><a href="conditionals.html#if-elif-and-else"><i class="fa fa-check"></i><b>4.1</b> if, elif, and else</a></li>
<li class="chapter" data-level="4.2" data-path="conditionals.html"><a href="conditionals.html#boolean-operators"><i class="fa fa-check"></i><b>4.2</b> Boolean Operators</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>5</b> Loops</a>
<ul>
<li class="chapter" data-level="5.1" data-path="loops.html"><a href="loops.html#for-loops"><i class="fa fa-check"></i><b>5.1</b> For loops</a></li>
<li class="chapter" data-level="5.2" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i><b>5.2</b> While Loop</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="loops.html"><a href="loops.html#break-statement"><i class="fa fa-check"></i><b>5.2.1</b> <code>break</code> statement</a></li>
<li class="chapter" data-level="5.2.2" data-path="loops.html"><a href="loops.html#continue-statement"><i class="fa fa-check"></i><b>5.2.2</b> <code>continue</code> statement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html"><i class="fa fa-check"></i><b>6</b> Built in Modules and Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#creating-a-module"><i class="fa fa-check"></i><b>6.1</b> Creating a module</a></li>
<li class="chapter" data-level="6.2" data-path="built-in-modules-and-functions.html"><a href="built-in-modules-and-functions.html#installing-external-modules-using-pip"><i class="fa fa-check"></i><b>6.2</b> Installing external modules using pip</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#lambda-function"><i class="fa fa-check"></i><b>7.1</b> Lambda function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html"><i class="fa fa-check"></i><b>8</b> Introduction to Numpy</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-numpy.html"><a href="introduction-to-numpy.html#why-is-numpy-fast"><i class="fa fa-check"></i><b>8.1</b> Why is NumPy Fast?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-reservoir-engineering.html"><a href="basic-reservoir-engineering.html"><i class="fa fa-check"></i>Basic Reservoir Engineering</a></li>
<li class="chapter" data-level="9" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html"><i class="fa fa-check"></i><b>9</b> Fundamental Properties of Fluid</a>
<ul>
<li class="chapter" data-level="9.1" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#review-of-gas-properties"><i class="fa fa-check"></i><b>9.1</b> Review of Gas Properties</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#real-gas-law"><i class="fa fa-check"></i><b>9.1.1</b> Real Gas law</a></li>
<li class="chapter" data-level="9.1.2" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#gas-z-factor"><i class="fa fa-check"></i><b>9.1.2</b> Gas z Factor</a></li>
<li class="chapter" data-level="9.1.3" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#gas-density"><i class="fa fa-check"></i><b>9.1.3</b> Gas Density</a></li>
<li class="chapter" data-level="9.1.4" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#isothermal-gas-compressibility"><i class="fa fa-check"></i><b>9.1.4</b> Isothermal Gas Compressibility</a></li>
<li class="chapter" data-level="9.1.5" data-path="fundamental-properties-of-fluid.html"><a href="fundamental-properties-of-fluid.html#gas-formation-volume-factor"><i class="fa fa-check"></i><b>9.1.5</b> Gas formation volume factor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="properties-of-oil.html"><a href="properties-of-oil.html"><i class="fa fa-check"></i><b>10</b> Properties of Oil</a></li>
<li class="chapter" data-level="11" data-path="rock-properties.html"><a href="rock-properties.html"><i class="fa fa-check"></i><b>11</b> Rock Properties</a>
<ul>
<li class="chapter" data-level="11.1" data-path="rock-properties.html"><a href="rock-properties.html#surface-and-interfacial-tension"><i class="fa fa-check"></i><b>11.1</b> Surface and Interfacial Tension</a></li>
<li class="chapter" data-level="11.2" data-path="rock-properties.html"><a href="rock-properties.html#simplified-fractional-flow-equation"><i class="fa fa-check"></i><b>11.2</b> Simplified Fractional Flow Equation</a></li>
<li class="chapter" data-level="11.3" data-path="rock-properties.html"><a href="rock-properties.html#buckley-leverett-theory"><i class="fa fa-check"></i><b>11.3</b> Buckley-Leverett Theory</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pattern-floods.html"><a href="pattern-floods.html"><i class="fa fa-check"></i><b>12</b> Pattern Floods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="pattern-floods.html"><a href="pattern-floods.html#recovery-efficiency"><i class="fa fa-check"></i><b>12.1</b> Recovery Efficiency</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="pattern-floods.html"><a href="pattern-floods.html#patterns-and-spacing"><i class="fa fa-check"></i><b>12.1.1</b> Patterns and Spacing</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="pattern-floods.html"><a href="pattern-floods.html#pattern-recovery"><i class="fa fa-check"></i><b>12.2</b> Pattern Recovery</a></li>
<li class="chapter" data-level="12.3" data-path="pattern-floods.html"><a href="pattern-floods.html#aa"><i class="fa fa-check"></i><b>12.3</b> aa</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="volumetrics.html"><a href="volumetrics.html"><i class="fa fa-check"></i><b>13</b> Volumetrics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="volumetrics.html"><a href="volumetrics.html#calculating-the-gas-inplace-by-volumetric-methods"><i class="fa fa-check"></i><b>13.1</b> Calculating the Gas inplace by volumetric methods</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html"><i class="fa fa-check"></i><b>14</b> Gas and Water Coning</a>
<ul>
<li class="chapter" data-level="14.1" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#coning-in-vertical-wells"><i class="fa fa-check"></i><b>14.1</b> Coning in Vertical wells</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#meyer-garder-correlation"><i class="fa fa-check"></i><b>14.1.1</b> Meyer-Garder Correlation</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="gas-and-water-coning.html"><a href="gas-and-water-coning.html#coning-in-horizontal-wells"><i class="fa fa-check"></i><b>14.2</b> Coning in Horizontal wells</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basic Reservoir Engineering in Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rock-properties" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Rock Properties</h1>
<div id="surface-and-interfacial-tension" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Surface and Interfacial Tension</h2>
<p>In dealing with multiphase systems, it is necessary to consider the
effect of the forces at the interface when two immiscible fluids are in contact. When these two fluids are liquid and gas, the term surface tension is
used to describe the forces acting on the interface. When the interface is
between two liquids, the acting forces are called interfacial tension. The surface or interfacial tension has the units of force per unit of
length, e.g., <code>dynes/cm</code>,
Assuming the radius of the capillary tube is <code>r</code>, the
total upward force <code>Fup</code>, which holds the liquid up, is equal to the force per
unit length of surface times the total length of surface, or
<span class="math display" id="eq:SurfaceTension">\[\begin{equation}
    \tag{11.1}
    F_{up} = 2\pi r \sigma_{gw} (cos\theta)
\end{equation}\]</span></p>
<p>where<br />
sigma_gw = surface tension between air (gas) and water (oil). dynes/cm<br />
theta = contact angle<br />
r = radius, cm<br />
</p>
<p>The upward force is counteracted by the weight of the water, which is
equivalent to a downward force of mass times acceleration, or
<span class="math display" id="eq:downForce">\[\begin{equation}
    \tag{11.2}
    F_{down} = \pi r^2 h (\rho_{w} -\rho_{air})g
\end{equation}\]</span></p>
<p>where h = height to which the liquid is held, cm<br />
g = acceleration due to gravity, cm/sec2<br />
Rho_w = density of water, gm/cm3<br />
Rho_air = density of gas, gm/cm3<br />
</p>
<p><strong>Currey Function fitting on experimental data</strong></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="rock-properties.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> optimize</span>
<span id="cb107-2"><a href="rock-properties.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb107-3"><a href="rock-properties.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb107-4"><a href="rock-properties.html#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="rock-properties.html#cb107-5" aria-hidden="true" tabindex="-1"></a>Swc <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb107-6"><a href="rock-properties.html#cb107-6" aria-hidden="true" tabindex="-1"></a>Swor <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb107-7"><a href="rock-properties.html#cb107-7" aria-hidden="true" tabindex="-1"></a>Kro <span class="op">=</span> <span class="fl">0.85</span> <span class="co"># kro  at Swc</span></span>
<span id="cb107-8"><a href="rock-properties.html#cb107-8" aria-hidden="true" tabindex="-1"></a>Krw<span class="op">=</span> <span class="fl">0.4</span> <span class="co"># Krw at Sorw</span></span>
<span id="cb107-9"><a href="rock-properties.html#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="rock-properties.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_func(Sw, no, nw):</span>
<span id="cb107-11"><a href="rock-properties.html#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Kro<span class="op">/</span>Krw<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Swc<span class="op">-</span>Swor)<span class="op">**</span>(nw<span class="op">-</span>no)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Sw<span class="op">-</span>Swor)<span class="op">**</span>no<span class="op">/</span>(Sw<span class="op">-</span>Swc)<span class="op">**</span>nw</span>
<span id="cb107-12"><a href="rock-properties.html#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="rock-properties.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_Ko(Sw, no):</span>
<span id="cb107-14"><a href="rock-properties.html#cb107-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Kro<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>Sw<span class="op">-</span>Swor)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Swc<span class="op">-</span>Swor))<span class="op">**</span>no</span>
<span id="cb107-15"><a href="rock-properties.html#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="rock-properties.html#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_Kw(Sw, nw):</span>
<span id="cb107-17"><a href="rock-properties.html#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Krw<span class="op">*</span>((Sw<span class="op">-</span>Swc)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Swc<span class="op">-</span>Swor))<span class="op">**</span>nw</span>
<span id="cb107-18"><a href="rock-properties.html#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="rock-properties.html#cb107-19" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/Rel-Perm.csv&#39;</span>)</span>
<span id="cb107-20"><a href="rock-properties.html#cb107-20" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Ratio_Ko_kw&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Ko&#39;</span>]<span class="op">/</span>df[<span class="st">&#39;Kw&#39;</span>] </span>
<span id="cb107-21"><a href="rock-properties.html#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="rock-properties.html#cb107-22" aria-hidden="true" tabindex="-1"></a>params, params_covariance <span class="op">=</span> optimize.curve_fit(test_func, df[<span class="st">&#39;Sw&#39;</span>], df[<span class="st">&#39;Ratio_Ko_kw&#39;</span>],p0<span class="op">=</span>[<span class="fl">1.5</span>, <span class="dv">4</span>])</span>
<span id="cb107-23"><a href="rock-properties.html#cb107-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-24"><a href="rock-properties.html#cb107-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-25"><a href="rock-properties.html#cb107-25" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb107-26"><a href="rock-properties.html#cb107-26" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">&#39;Sw&#39;</span>], df[<span class="st">&#39;Ko&#39;</span>], <span class="st">&#39;k^&#39;</span>, )</span>
<span id="cb107-27"><a href="rock-properties.html#cb107-27" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">&#39;Sw&#39;</span>], df[<span class="st">&#39;Kw&#39;</span>],<span class="st">&#39;k.&#39;</span>)</span>
<span id="cb107-28"><a href="rock-properties.html#cb107-28" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb107-29"><a href="rock-properties.html#cb107-29" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb107-30"><a href="rock-properties.html#cb107-30" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">&#39;Sw&#39;</span>], get_Ko(df[<span class="st">&#39;Sw&#39;</span>], params[<span class="dv">0</span>]), <span class="st">&#39;r--&#39;</span>)</span>
<span id="cb107-31"><a href="rock-properties.html#cb107-31" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">&#39;Sw&#39;</span>], get_Kw(df[<span class="st">&#39;Sw&#39;</span>], params[<span class="dv">1</span>]), <span class="st">&#39;b--&#39;</span>)</span>
<span id="cb107-32"><a href="rock-properties.html#cb107-32" aria-hidden="true" tabindex="-1"></a>plt.legend((<span class="st">&#39;Ko&#39;</span>, <span class="st">&#39;Kw&#39;</span>, <span class="st">&#39;Ko fitted no = &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">round</span>(params[<span class="dv">0</span>], <span class="dv">2</span>)),<span class="st">&#39;Kw fitted nw = &#39;</span><span class="op">+</span> <span class="bu">str</span>(<span class="bu">round</span>(params[<span class="dv">1</span>], <span class="dv">2</span>)) ),loc<span class="op">=</span><span class="st">&#39;upper center&#39;</span>)</span>
<span id="cb107-33"><a href="rock-properties.html#cb107-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="images/relPerm%20-1.png" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="rock-properties.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(params)  <span class="co"># the parameters are &#39;no&#39; and &#39;nw&#39;</span></span></code></pre></div>
<p><strong>Curve fitting in experimental data</strong></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="rock-properties.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suppose we have experimental data of relative permeability and we want to curve fit on this data.</span></span>
<span id="cb109-2"><a href="rock-properties.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="rock-properties.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> interpolate</span>
<span id="cb109-4"><a href="rock-properties.html#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="rock-properties.html#cb109-5" aria-hidden="true" tabindex="-1"></a>Sw <span class="op">=</span> np.arange(<span class="fl">0.2</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span>)</span>
<span id="cb109-6"><a href="rock-properties.html#cb109-6" aria-hidden="true" tabindex="-1"></a>krw <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="fl">.002</span>, <span class="fl">.02</span>, <span class="fl">.04</span>, <span class="fl">.07</span>, <span class="fl">.11</span>, <span class="fl">.15</span>, <span class="fl">.22</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>])</span>
<span id="cb109-7"><a href="rock-properties.html#cb109-7" aria-hidden="true" tabindex="-1"></a>kro <span class="op">=</span> np.array([<span class="fl">.6</span>, <span class="fl">.5</span>, <span class="fl">.4</span>, <span class="fl">.3</span>, <span class="fl">.23</span>, <span class="fl">.17</span>, <span class="fl">.12</span>, <span class="fl">.08</span>, <span class="fl">.05</span>, <span class="fl">.03</span>, <span class="fl">.02</span>, <span class="fl">.01</span>, <span class="fl">.005</span>, <span class="dv">0</span>])</span>
<span id="cb109-8"><a href="rock-properties.html#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="rock-properties.html#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Spline interpolation of data</span></span>
<span id="cb109-10"><a href="rock-properties.html#cb109-10" aria-hidden="true" tabindex="-1"></a>krw_interp <span class="op">=</span> interpolate.splrep(Sw, krw, s<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb109-11"><a href="rock-properties.html#cb109-11" aria-hidden="true" tabindex="-1"></a>kro_interp <span class="op">=</span> interpolate.splrep(Sw, kro, s<span class="op">=</span><span class="dv">0</span>) </span>
<span id="cb109-12"><a href="rock-properties.html#cb109-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-13"><a href="rock-properties.html#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_Kro_Krw_at_sw(Sw_new):</span>
<span id="cb109-14"><a href="rock-properties.html#cb109-14" aria-hidden="true" tabindex="-1"></a>    krw_new <span class="op">=</span> interpolate.splev(Sw_new, krw_interp, der<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb109-15"><a href="rock-properties.html#cb109-15" aria-hidden="true" tabindex="-1"></a>    kro_new <span class="op">=</span> interpolate.splev(Sw_new, kro_interp, der<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb109-16"><a href="rock-properties.html#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> krw_new, kro_new</span>
<span id="cb109-17"><a href="rock-properties.html#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="rock-properties.html#cb109-18" aria-hidden="true" tabindex="-1"></a>Sw_given <span class="op">=</span> <span class="fl">0.567</span>        <span class="co"># we want to find Kro and Krw at this saturation</span></span>
<span id="cb109-19"><a href="rock-properties.html#cb109-19" aria-hidden="true" tabindex="-1"></a>krw_cal, kro_cal <span class="op">=</span> get_Kro_Krw_at_sw( Sw_given)</span>
<span id="cb109-20"><a href="rock-properties.html#cb109-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-21"><a href="rock-properties.html#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;at given Sw : </span><span class="sc">{</span>Sw_given<span class="sc">}</span><span class="ss"> Kro := </span><span class="sc">{</span>kro_cal<span class="sc">}</span><span class="ss"> &amp; Krw := </span><span class="sc">{</span>krw_cal<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb109-22"><a href="rock-properties.html#cb109-22" aria-hidden="true" tabindex="-1"></a>at given Sw : <span class="fl">0.567</span> Kro :<span class="op">=</span> <span class="fl">0.06870642488480108</span> <span class="op">&amp;</span> Krw :<span class="op">=</span> <span class="fl">0.2458867331261035</span></span></code></pre></div>
<p><strong>Calculate Fw curve</strong>
The fractional flow of water is the ratio of water production rate to total production rate. In the case of an oil-water system, the fractional flow of water is given by:
<span class="math display" id="eq:Fwsimple">\[\begin{equation}
    f_{w} = \frac{q_{w}}{q_{w} + q_{o} }
    \tag{11.3}
\end{equation}\]</span></p>
<p>Notice that the flow rates are expressed in terms of reservoir volumes. The fractional flow of oil <code>fw</code>, and the fractional flow of water are related by <code>fw= 1 - fw</code> for an oil-water system. Based on the definition of fractional flow, we see that fractional flow should be a value between 0 and 1.</p>
</div>
<div id="simplified-fractional-flow-equation" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Simplified Fractional Flow Equation</h2>
<p>A simplified fractional flow equation is obtained by replacing flow rates with Darcy’s Law in the definition of fractional flow. If we neglect capillary pressure and gravity for simplicity, we obtain
<span class="math display" id="eq:qwEquation">\[\begin{equation}
        q_{w} = \frac{kk_{r_{w}}A}{\mu_{w}}\frac{\partial P_{w}}{\partial x}
        \tag{11.4}
    \end{equation}\]</span>
where A is cross-sectional area and P is pressure of phase. Since capillary pressure is neglected, we have equal phase pressure so <code>Pw = Po</code>. if we put <a href="rock-properties.html#eq:qwEquation">(11.4)</a> in fractional flow equation given <a href="rock-properties.html#eq:Fwsimple">(11.3)</a> and simplify it we will get</p>
<p><span class="math display" id="eq:fwFinal">\[\begin{equation}
    \tag{11.5}
    f_{w} = \frac{\frac{k_{r_{w}}}{\mu_{w}}}{\frac{k_{r_{w}}}{\mu_{w}} + \frac{k_{r_{o}}}{\mu_{o}}}
\end{equation}\]</span></p>
<p>Mobility of a phase can be defined as</p>
<p><span class="math display" id="eq:mobility">\[\begin{equation}
    \tag{11.6}
    \lambda_{w} = \frac{k_{r_{w}}}{\mu_{w}}
\end{equation}\]</span></p>
<p>expressing <a href="rock-properties.html#eq:fwFinal">(11.5)</a> in term of <a href="rock-properties.html#eq:mobility">(11.6)</a></p>
<p><span class="math display" id="eq:fwmobility">\[\begin{equation}
    \tag{11.7}
    f_{w} = \frac{1}{1 + \frac{\lambda_{o}}{\lambda_{w}}}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="rock-properties.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taking the data from above</span></span>
<span id="cb110-2"><a href="rock-properties.html#cb110-2" aria-hidden="true" tabindex="-1"></a>Sw <span class="op">=</span> np.arange(<span class="fl">0.2</span>, <span class="fl">0.9</span>, <span class="fl">0.01</span>)</span>
<span id="cb110-3"><a href="rock-properties.html#cb110-3" aria-hidden="true" tabindex="-1"></a>muo <span class="op">=</span> <span class="fl">0.25</span> <span class="co"># cp</span></span>
<span id="cb110-4"><a href="rock-properties.html#cb110-4" aria-hidden="true" tabindex="-1"></a>muw <span class="op">=</span> <span class="dv">1</span> <span class="co"># cp</span></span>
<span id="cb110-5"><a href="rock-properties.html#cb110-5" aria-hidden="true" tabindex="-1"></a>Fw <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb110-6"><a href="rock-properties.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (<span class="bu">len</span>(Sw)): </span>
<span id="cb110-7"><a href="rock-properties.html#cb110-7" aria-hidden="true" tabindex="-1"></a>    krw_cal, kro_cal <span class="op">=</span> get_Kro_Krw_at_sw( Sw[i])</span>
<span id="cb110-8"><a href="rock-properties.html#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> krw_cal <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb110-9"><a href="rock-properties.html#cb110-9" aria-hidden="true" tabindex="-1"></a>        Fw.append(<span class="dv">0</span>)</span>
<span id="cb110-10"><a href="rock-properties.html#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-11"><a href="rock-properties.html#cb110-11" aria-hidden="true" tabindex="-1"></a>        Fw.append(<span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> (kro_cal <span class="op">/</span> muo) <span class="op">*</span> (muw <span class="op">/</span> krw_cal)))</span>
<span id="cb110-12"><a href="rock-properties.html#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="rock-properties.html#cb110-13" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb110-14"><a href="rock-properties.html#cb110-14" aria-hidden="true" tabindex="-1"></a>plt.plot(Sw, Fw, <span class="st">&#39;b-&#39;</span>, )</span>
<span id="cb110-15"><a href="rock-properties.html#cb110-15" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb110-16"><a href="rock-properties.html#cb110-16" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb110-17"><a href="rock-properties.html#cb110-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;fraction flow&#39;</span>)</span>
<span id="cb110-18"><a href="rock-properties.html#cb110-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Sw&#39;</span>)</span>
<span id="cb110-19"><a href="rock-properties.html#cb110-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Fraction flow curve&#39;</span>)</span>
<span id="cb110-20"><a href="rock-properties.html#cb110-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="images/unnamed-chunk-96-1.png" /><!-- --></p>
<p><strong>Calculate Fw Equation with Gravity</strong></p>
<p>Gravity can be included in the fractional flow equation as follows. First, let us consider the two-phase flow of oil and water in a tilted linear system. Darcy’s Law including capillary pressure and gravity effects for linear flow is</p>
<p><span class="math display" id="eq:qwEquationGravity">\[\begin{equation}
        q_{w} = - \frac{kk_{r_{w}}A}{\mu_{w}}\Bigg(\frac{\partial P_{w}}{\partial x} + \rho_{w}g\sin\alpha \Bigg) \\

        q_{o} = - \frac{kk_{r_{o}}A}{\mu_{o}}\Bigg(\frac{\partial P_{o}}{\partial x} + \rho_{o}g\sin\alpha&#39; \Bigg)

        \tag{11.8}
\end{equation}\]</span></p>
<p>If we differentiate capillary pressure for a water-wet system with respect to position x along the dipping bed, we find</p>
<p><span class="math display" id="eq:capillary">\[\begin{equation}
    \tag{11.9}
    \frac{\partial P_{cow}}{\partial x} = \frac{\partial P_{o}}{\partial x} -\frac{\partial P_{w}}{\partial x}
\end{equation}\]</span></p>
<p>Rearranging and collecting terms gives the fractional flow to water fw in conventional oilfield units:</p>
<p><span class="math display" id="eq:fwGravity">\[\begin{equation}
    \tag{11.10}
    f_{w} = \frac{1+0.001127 \frac{Akk_{ro}}{\mu_{o}q_{t}}\Big(\frac{\partial P_{cow}}{\partial x}  - 0.433(\gamma_{w} - \gamma_{o})\sin\alpha  \Big)}{1 + \frac{k_{ro}}{k_{rw}}\frac{\mu_{w}}{\mu_{o}}}
\end{equation}\]</span></p>
<p>where</p>
<p><code>A</code> cross-sectional area of flow system <code>ft2</code>,
<code>k</code> absolute permeability <code>md</code>,
<code>kro</code> relative permeability to oil,
<code>kw</code> relative permeability to water,
oil viscosity <code>cp</code>,
water viscosity <code>cp</code>,
<code>Pcow</code> oil-water capillary pressure <code>psi</code> = P0 - Pw,
<code>x</code> direction of linear flow <code>ft</code>,
<code>alpha</code> dip angle of formation <code>degrees</code>,
<code>gamma</code> oil specific gravity (water =1),
<code>gamma</code> water specific gravity (water = 1 ),</p>
</div>
<div id="buckley-leverett-theory" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Buckley-Leverett Theory</h2>
<p>One of the simplest and most widely used methods of estimating the advance of a fluid displacement front in an immiscible displacement process is the Buckley-Leverett method. Buckley-Leverett Theory [1942] estimates the rate at which an injected water bank moves through a porous medium. The approach uses fractional flow theory and is based on the following assumptions:</p>
<ul>
<li>Flow is linear and horizontal</li>
<li>Water is injected into an oil reservoir</li>
<li>Oil and water are both incompressible</li>
<li>Oil and water are immiscible</li>
<li>Gravity and capillary pressure effects are negligible</li>
</ul>
<p>Frontal advance theory is an application of the law of conservation of mass. Flow through a small volume element with length x and cross-sectional area A</p>
<p>The change in water saturation per unit time can be written as</p>
<p><span class="math display" id="eq:BLEquation">\[\begin{equation}
    \tag{11.11}
    \frac{\partial S_{w}}{\partial t} = \frac{-q}{A \phi} \frac{\partial f_{w}}{\partial S_{w}}\frac{\partial S_{w}}{\partial x}
\end{equation}\]</span></p>
<p>The python code to solve BL curve is given <a href="https://github.com/yohanesnuwara/pyreservoir">below</a></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="rock-properties.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> buckley_leverett1d(nt, Sw0, L, nx, sigma, bc_value, muw, muo, q, A, poro, Sw_data, krw_data, kro_data):</span>
<span id="cb111-2"><a href="rock-properties.html#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot; </span></span>
<span id="cb111-3"><a href="rock-properties.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Solve Buckley-Leverett PDE using forward-time/backward-space scheme</span></span>
<span id="cb111-4"><a href="rock-properties.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb111-5"><a href="rock-properties.html#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> interstitial_velocity(q, A, poro):</span>
<span id="cb111-6"><a href="rock-properties.html#cb111-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># interstitial velocity vt</span></span>
<span id="cb111-7"><a href="rock-properties.html#cb111-7" aria-hidden="true" tabindex="-1"></a>        vt <span class="op">=</span> q <span class="op">/</span> A <span class="op">*</span> poro</span>
<span id="cb111-8"><a href="rock-properties.html#cb111-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vt</span>
<span id="cb111-9"><a href="rock-properties.html#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="rock-properties.html#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fractional_flow(krw, muw, kro, muo):</span>
<span id="cb111-11"><a href="rock-properties.html#cb111-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fractional flow Fww</span></span>
<span id="cb111-12"><a href="rock-properties.html#cb111-12" aria-hidden="true" tabindex="-1"></a>        Fww <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> (kro <span class="op">/</span> muo) <span class="op">*</span> (muw <span class="op">/</span> krw))</span>
<span id="cb111-13"><a href="rock-properties.html#cb111-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Fww    </span>
<span id="cb111-14"><a href="rock-properties.html#cb111-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-15"><a href="rock-properties.html#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate interstitial velocity</span></span>
<span id="cb111-16"><a href="rock-properties.html#cb111-16" aria-hidden="true" tabindex="-1"></a>    vt <span class="op">=</span> interstitial_velocity(q, A, poro)</span>
<span id="cb111-17"><a href="rock-properties.html#cb111-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-18"><a href="rock-properties.html#cb111-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate dx</span></span>
<span id="cb111-19"><a href="rock-properties.html#cb111-19" aria-hidden="true" tabindex="-1"></a>    dx <span class="op">=</span> L <span class="op">/</span> (nx <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb111-20"><a href="rock-properties.html#cb111-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-21"><a href="rock-properties.html#cb111-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate dt from CFwL</span></span>
<span id="cb111-22"><a href="rock-properties.html#cb111-22" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> sigma <span class="op">*</span> dx <span class="op">/</span> vt  <span class="co"># time-step size </span></span>
<span id="cb111-23"><a href="rock-properties.html#cb111-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-24"><a href="rock-properties.html#cb111-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Discretize the domain.</span></span>
<span id="cb111-25"><a href="rock-properties.html#cb111-25" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="fl">0.0</span>, L, num<span class="op">=</span>nx)   </span>
<span id="cb111-26"><a href="rock-properties.html#cb111-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-27"><a href="rock-properties.html#cb111-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># integrate solution in time</span></span>
<span id="cb111-28"><a href="rock-properties.html#cb111-28" aria-hidden="true" tabindex="-1"></a>    Sw_hist <span class="op">=</span> [Sw0.copy()]</span>
<span id="cb111-29"><a href="rock-properties.html#cb111-29" aria-hidden="true" tabindex="-1"></a>    Sw <span class="op">=</span> Sw0.copy()</span>
<span id="cb111-30"><a href="rock-properties.html#cb111-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(nt):</span>
<span id="cb111-31"><a href="rock-properties.html#cb111-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute the fractional flow.</span></span>
<span id="cb111-32"><a href="rock-properties.html#cb111-32" aria-hidden="true" tabindex="-1"></a>        krw, kro <span class="op">=</span> get_Kro_Krw_at_sw(Sw)</span>
<span id="cb111-33"><a href="rock-properties.html#cb111-33" aria-hidden="true" tabindex="-1"></a>        Fw <span class="op">=</span> fractional_flow(krw, muw, kro, muo)</span>
<span id="cb111-34"><a href="rock-properties.html#cb111-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb111-35"><a href="rock-properties.html#cb111-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Advance in time.</span></span>
<span id="cb111-36"><a href="rock-properties.html#cb111-36" aria-hidden="true" tabindex="-1"></a>        Sw[<span class="dv">1</span>:] <span class="op">=</span> Sw[<span class="dv">1</span>:] <span class="op">-</span> (vt <span class="op">*</span> dt <span class="op">/</span> dx) <span class="op">*</span> (Fw[<span class="dv">1</span>:] <span class="op">-</span> Fw[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb111-37"><a href="rock-properties.html#cb111-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb111-38"><a href="rock-properties.html#cb111-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set the left boundary condition.</span></span>
<span id="cb111-39"><a href="rock-properties.html#cb111-39" aria-hidden="true" tabindex="-1"></a>        Sw[<span class="dv">0</span>] <span class="op">=</span> bc_value</span>
<span id="cb111-40"><a href="rock-properties.html#cb111-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb111-41"><a href="rock-properties.html#cb111-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Record the time-step solution.</span></span>
<span id="cb111-42"><a href="rock-properties.html#cb111-42" aria-hidden="true" tabindex="-1"></a>        Sw_hist.append(Sw.copy()) </span>
<span id="cb111-43"><a href="rock-properties.html#cb111-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-44"><a href="rock-properties.html#cb111-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot Sw over x</span></span>
<span id="cb111-45"><a href="rock-properties.html#cb111-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig = pyplot.figure(figsize=(6.0, 4.0))</span></span>
<span id="cb111-46"><a href="rock-properties.html#cb111-46" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="vs">r&#39;$x$&#39;</span>)</span>
<span id="cb111-47"><a href="rock-properties.html#cb111-47" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="vs">r&#39;Sw&#39;</span>)</span>
<span id="cb111-48"><a href="rock-properties.html#cb111-48" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span>
<span id="cb111-49"><a href="rock-properties.html#cb111-49" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, Sw0, label<span class="op">=</span><span class="st">&#39;Initial&#39;</span>,</span>
<span id="cb111-50"><a href="rock-properties.html#cb111-50" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">&#39;C0&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb111-51"><a href="rock-properties.html#cb111-51" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, Sw, label<span class="op">=</span><span class="st">&#39;nt = </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(nt),</span>
<span id="cb111-52"><a href="rock-properties.html#cb111-52" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">&#39;C1&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb111-53"><a href="rock-properties.html#cb111-53" aria-hidden="true" tabindex="-1"></a>    plt.xlim(<span class="fl">0.0</span>, L)</span>
<span id="cb111-54"><a href="rock-properties.html#cb111-54" aria-hidden="true" tabindex="-1"></a>    plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)  </span>
<span id="cb111-55"><a href="rock-properties.html#cb111-55" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb111-56"><a href="rock-properties.html#cb111-56" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span>
<span id="cb111-57"><a href="rock-properties.html#cb111-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-58"><a href="rock-properties.html#cb111-58" aria-hidden="true" tabindex="-1"></a>Sw <span class="op">=</span> np.arange(<span class="fl">0.2</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span>)</span>
<span id="cb111-59"><a href="rock-properties.html#cb111-59" aria-hidden="true" tabindex="-1"></a>krw <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="fl">.002</span>, <span class="fl">.02</span>, <span class="fl">.04</span>, <span class="fl">.07</span>, <span class="fl">.11</span>, <span class="fl">.15</span>, <span class="fl">.22</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>])</span>
<span id="cb111-60"><a href="rock-properties.html#cb111-60" aria-hidden="true" tabindex="-1"></a>kro <span class="op">=</span> np.array([<span class="fl">.6</span>, <span class="fl">.5</span>, <span class="fl">.4</span>, <span class="fl">.3</span>, <span class="fl">.23</span>, <span class="fl">.17</span>, <span class="fl">.12</span>, <span class="fl">.08</span>, <span class="fl">.05</span>, <span class="fl">.03</span>, <span class="fl">.02</span>, <span class="fl">.01</span>, <span class="fl">.005</span>, <span class="dv">0</span>])</span>
<span id="cb111-61"><a href="rock-properties.html#cb111-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-62"><a href="rock-properties.html#cb111-62" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters for initial condition</span></span>
<span id="cb111-63"><a href="rock-properties.html#cb111-63" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb111-64"><a href="rock-properties.html#cb111-64" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="dv">401</span></span>
<span id="cb111-65"><a href="rock-properties.html#cb111-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-66"><a href="rock-properties.html#cb111-66" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="fl">0.0</span>, L, nx) </span>
<span id="cb111-67"><a href="rock-properties.html#cb111-67" aria-hidden="true" tabindex="-1"></a>Sw0 <span class="op">=</span> np.full(nx, <span class="fl">0.2</span>)</span>
<span id="cb111-68"><a href="rock-properties.html#cb111-68" aria-hidden="true" tabindex="-1"></a>Sw0[:<span class="dv">15</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb111-69"><a href="rock-properties.html#cb111-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-70"><a href="rock-properties.html#cb111-70" aria-hidden="true" tabindex="-1"></a>plt.plot(x, Sw0)</span>
<span id="cb111-71"><a href="rock-properties.html#cb111-71" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="bu">min</span>(x), <span class="bu">max</span>(x))</span>
<span id="cb111-72"><a href="rock-properties.html#cb111-72" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;x&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Sw&#39;</span>)</span>
<span id="cb111-73"><a href="rock-properties.html#cb111-73" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Initial Condition&#39;</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb111-74"><a href="rock-properties.html#cb111-74" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb111-75"><a href="rock-properties.html#cb111-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-76"><a href="rock-properties.html#cb111-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters for simulation</span></span></code></pre></div>
<p><img src="images/BL-1.png" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="rock-properties.html#cb112-1" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> <span class="dv">70</span></span>
<span id="cb112-2"><a href="rock-properties.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L = 4</span></span>
<span id="cb112-3"><a href="rock-properties.html#cb112-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb112-4"><a href="rock-properties.html#cb112-4" aria-hidden="true" tabindex="-1"></a>bc_value <span class="op">=</span> Sw0[<span class="dv">0</span>]</span>
<span id="cb112-5"><a href="rock-properties.html#cb112-5" aria-hidden="true" tabindex="-1"></a>u_max <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb112-6"><a href="rock-properties.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="rock-properties.html#cb112-7" aria-hidden="true" tabindex="-1"></a>muw <span class="op">=</span> <span class="fl">0.5E-3</span></span>
<span id="cb112-8"><a href="rock-properties.html#cb112-8" aria-hidden="true" tabindex="-1"></a>muo <span class="op">=</span> <span class="fl">1E-3</span></span>
<span id="cb112-9"><a href="rock-properties.html#cb112-9" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="dv">200</span> <span class="co"># m3/hr</span></span>
<span id="cb112-10"><a href="rock-properties.html#cb112-10" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="dv">30</span> <span class="co"># m2</span></span>
<span id="cb112-11"><a href="rock-properties.html#cb112-11" aria-hidden="true" tabindex="-1"></a>poro <span class="op">=</span> <span class="fl">0.24</span></span>
<span id="cb112-12"><a href="rock-properties.html#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation</span></span>
<span id="cb112-13"><a href="rock-properties.html#cb112-13" aria-hidden="true" tabindex="-1"></a>nt <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">500</span>, <span class="dv">700</span>, <span class="dv">900</span>, <span class="dv">1200</span>, <span class="dv">2000</span>]</span>
<span id="cb112-14"><a href="rock-properties.html#cb112-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-15"><a href="rock-properties.html#cb112-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">9</span>))</span>
<span id="cb112-16"><a href="rock-properties.html#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(nt)):</span>
<span id="cb112-17"><a href="rock-properties.html#cb112-17" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">3</span>,<span class="dv">2</span>,i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb112-18"><a href="rock-properties.html#cb112-18" aria-hidden="true" tabindex="-1"></a>    buckley_leverett1d(nt[i], Sw0, L, nx, sigma, bc_value, muw, muo, q, A, poro, Sw, krw, kro)</span>
<span id="cb112-19"><a href="rock-properties.html#cb112-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="images/BL-2.png" /><!-- --></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="properties-of-oil.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pattern-floods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
